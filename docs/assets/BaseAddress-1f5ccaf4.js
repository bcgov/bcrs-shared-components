var de=Object.defineProperty;var ne=(r,e,s)=>e in r?de(r,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[e]=s;var m=(r,e,s)=>(ne(r,typeof e!="symbol"?e+"":e,s),s);import{V as ie}from"./vue.esm-b1e57a2f.js";import{c as oe,m as le,C as ue,P as h,E as Y,n as ce}from"./_plugin-vue2_normalizer-b11a0120.js";import{W as v}from"./Watch-62f8b699.js";import{l as fe}from"./lodash-bc5bedbb.js";import{V as G,C as J}from"./validation-mixin-aac6b4a2.js";var a={},b={},d={},P={},f={};Object.defineProperty(f,"__esModule",{value:!0});var me=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var t in s)Object.prototype.hasOwnProperty.call(s,t)&&(r[t]=s[t])}return r};f.pushParams=X;f.popParams=ee;f.withParams=ve;var Q=[],p=f.target=null;f._setTarget=function(e){f.target=p=e};function X(){p!==null&&Q.push(p),f.target=p={}}function ee(){var r=p,e=f.target=p=Q.pop()||null;return e&&(Array.isArray(e.$sub)||(e.$sub=[]),e.$sub.push(r)),r}function pe(r){if(typeof r=="object"&&!Array.isArray(r))f.target=p=me({},p,r);else throw new Error("params must be an object")}function he(r,e){return se(function(s){return function(){s(r);for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return e.apply(this,n)}})}function se(r){var e=r(pe);return function(){X();try{for(var s=arguments.length,t=Array(s),n=0;n<s;n++)t[n]=arguments[n];return e.apply(this,t)}finally{ee()}}}function ve(r,e){return typeof r=="object"&&e!==void 0?he(r,e):se(r)}Object.defineProperty(P,"__esModule",{value:!0});var _e=f.withParams;P.default=_e;Object.defineProperty(d,"__esModule",{value:!0});d.regex=d.ref=d.len=d.req=d.withParams=void 0;var ge=P,re=ye(ge);function ye(r){return r&&r.__esModule?r:{default:r}}d.withParams=re.default;var Ce=d.req=function(e){if(Array.isArray(e))return!!e.length;if(e==null||e===!1)return!1;if(e instanceof Date)return!isNaN(e.getTime());if(typeof e=="object"){for(var s in e)return!0;return!1}return!!String(e).length};d.len=function(e){return Array.isArray(e)?e.length:typeof e=="object"?Object.keys(e).length:String(e).length};d.ref=function(e,s,t){return typeof e=="function"?e.call(s,t):t[e]};d.regex=function(e,s){return(0,re.default)({type:e},function(t){return!Ce(t)||s.test(t)})};Object.defineProperty(b,"__esModule",{value:!0});var Ae=d;b.default=(0,Ae.regex)("alpha",/^[a-zA-Z]*$/);var w={};Object.defineProperty(w,"__esModule",{value:!0});var Le=d;w.default=(0,Le.regex)("alphaNum",/^[a-zA-Z0-9]*$/);var x={};Object.defineProperty(x,"__esModule",{value:!0});var be=d;x.default=(0,be.regex)("numeric",/^[0-9]*$/);var R={};Object.defineProperty(R,"__esModule",{value:!0});var E=d;R.default=function(r,e){return(0,E.withParams)({type:"between",min:r,max:e},function(s){return!(0,E.req)(s)||(!/\s/.test(s)||s instanceof Date)&&+r<=+s&&+e>=+s})};var q={};Object.defineProperty(q,"__esModule",{value:!0});var Pe=d,we=/(^$|^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$)/;q.default=(0,Pe.regex)("email",we);var $={};Object.defineProperty($,"__esModule",{value:!0});var Z=d;$.default=(0,Z.withParams)({type:"ipAddress"},function(r){if(!(0,Z.req)(r))return!0;if(typeof r!="string")return!1;var e=r.split(".");return e.length===4&&e.every(xe)});var xe=function(e){if(e.length>3||e.length===0||e[0]==="0"&&e!=="0"||!e.match(/^\d+$/))return!1;var s=+e|0;return s>=0&&s<=255},O={};Object.defineProperty(O,"__esModule",{value:!0});var F=d;O.default=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:":";return(0,F.withParams)({type:"macAddress"},function(e){if(!(0,F.req)(e))return!0;if(typeof e!="string")return!1;var s=typeof r=="string"&&r!==""?e.split(r):e.length===12||e.length===16?e.match(/.{2}/g):null;return s!==null&&(s.length===6||s.length===8)&&s.every(Re)})};var Re=function(e){return e.toLowerCase().match(/^[0-9a-f]{2}$/)},I={};Object.defineProperty(I,"__esModule",{value:!0});var y=d;I.default=function(r){return(0,y.withParams)({type:"maxLength",max:r},function(e){return!(0,y.req)(e)||(0,y.len)(e)<=r})};var j={};Object.defineProperty(j,"__esModule",{value:!0});var C=d;j.default=function(r){return(0,C.withParams)({type:"minLength",min:r},function(e){return!(0,C.req)(e)||(0,C.len)(e)>=r})};var V={};Object.defineProperty(V,"__esModule",{value:!0});var H=d;V.default=(0,H.withParams)({type:"required"},H.req);var M={};Object.defineProperty(M,"__esModule",{value:!0});var A=d;M.default=function(r){return(0,A.withParams)({type:"requiredIf",prop:r},function(e,s){return(0,A.ref)(r,this,s)?(0,A.req)(e):!0})};var S={};Object.defineProperty(S,"__esModule",{value:!0});var L=d;S.default=function(r){return(0,L.withParams)({type:"requiredUnless",prop:r},function(e,s){return(0,L.ref)(r,this,s)?!0:(0,L.req)(e)})};var z={};Object.defineProperty(z,"__esModule",{value:!0});var k=d;z.default=function(r){return(0,k.withParams)({type:"sameAs",eq:r},function(e,s){return e===(0,k.ref)(r,this,s)})};var D={};Object.defineProperty(D,"__esModule",{value:!0});var qe=d,$e=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i;D.default=(0,qe.regex)("url",$e);var N={};Object.defineProperty(N,"__esModule",{value:!0});var Oe=d;N.default=function(){for(var r=arguments.length,e=Array(r),s=0;s<r;s++)e[s]=arguments[s];return(0,Oe.withParams)({type:"or"},function(){for(var t=this,n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return e.length>0&&e.reduce(function(_,g){return _||g.apply(t,o)},!1)})};var B={};Object.defineProperty(B,"__esModule",{value:!0});var Ie=d;B.default=function(){for(var r=arguments.length,e=Array(r),s=0;s<r;s++)e[s]=arguments[s];return(0,Ie.withParams)({type:"and"},function(){for(var t=this,n=arguments.length,o=Array(n),l=0;l<n;l++)o[l]=arguments[l];return e.length>0&&e.reduce(function(_,g){return _&&g.apply(t,o)},!0)})};var U={};Object.defineProperty(U,"__esModule",{value:!0});var W=d;U.default=function(r){return(0,W.withParams)({type:"minValue",min:r},function(e){return!(0,W.req)(e)||(!/\s/.test(e)||e instanceof Date)&&+e>=+r})};var T={};Object.defineProperty(T,"__esModule",{value:!0});var K=d;T.default=function(r){return(0,K.withParams)({type:"maxValue",max:r},function(e){return!(0,K.req)(e)||(!/\s/.test(e)||e instanceof Date)&&+e<=+r})};Object.defineProperty(a,"__esModule",{value:!0});a.maxValue=a.minValue=a.and=a.or=a.url=a.sameAs=a.requiredUnless=a.requiredIf=te=a.required=a.minLength=a.maxLength=a.macAddress=a.ipAddress=a.email=a.between=a.numeric=a.alphaNum=a.alpha=void 0;var je=b,Ve=i(je),Me=w,Se=i(Me),ze=x,De=i(ze),Ne=R,Be=i(Ne),Ue=q,Te=i(Ue),Ee=$,Ze=i(Ee),Fe=O,He=i(Fe),ke=I,We=i(ke),Ke=j,Ye=i(Ke),Ge=V,Je=i(Ge),Qe=M,Xe=i(Qe),es=S,ss=i(es),rs=z,ts=i(rs),as=D,ds=i(as),ns=N,is=i(ns),os=B,ls=i(os),us=U,cs=i(us),fs=T,ms=i(fs);function i(r){return r&&r.__esModule?r:{default:r}}a.alpha=Ve.default;a.alphaNum=Se.default;a.numeric=De.default;a.between=Be.default;a.email=Te.default;a.ipAddress=Ze.default;a.macAddress=He.default;a.maxLength=We.default;a.minLength=Ye.default;var te=a.required=Je.default;a.requiredIf=Xe.default;a.requiredUnless=ss.default;a.sameAs=ts.default;a.url=ds.default;a.or=is.default;a.and=ls.default;a.minValue=cs.default;a.maxValue=ms.default;const ps=function(){const r=this.$vnode.componentOptions.Ctor.options.__validations||{},e={};for(const s in r){if(!r.hasOwnProperty(s))continue;let t=r[s];s==="__validations__"&&(t=this[t]),typeof t=="function"&&(t=t.call(this)),s==="__validations__"?Object.assign(e,t):e[s]=t}return e};function hs(){return oe((r,e)=>{r.__validations||(r.__validations={}),r.__validations.__validations__=e,r.validations=ps})}var vs=Object.defineProperty,_s=Object.getOwnPropertyDescriptor,c=(r,e,s,t)=>{for(var n=t>1?void 0:t?_s(e,s):e,o=r.length-1,l;o>=0;o--)(l=r[o])&&(n=(t?l(e,s,n):l(n))||n);return t&&n&&vs(e,s,n),n};let u=class extends le(G,J){constructor(){super(...arguments);m(this,"address");m(this,"editing");m(this,"schema");m(this,"noPoBox");m(this,"addressLocal",{});m(this,"schemaLocal",{});m(this,"uniqueId",fe.uniqueId());m(this,"spaceRules",[s=>!/^\s/g.test(s)||"Invalid spaces",s=>!/\s$/g.test(s)||"Invalid spaces",s=>!/\s\s/g.test(s)||"Invalid word spacing"])}validations(){return{addressLocal:{...this.schemaLocal}}}resetRegion(){this.addressLocal.addressRegion=""}get streetAddressId(){return`street-address-${this.uniqueId}`}addressCountryId(){return`address-country-${this.uniqueId}`}get addressCountry(){return this.addressLocal.addressCountry}get streetAddressAdditionalLabel(){return"Additional Street Address"+(this.isSchemaRequired("streetAddressAdditional")?"":" (Optional)")}get streetAddressLabel(){return"Street Address"+(this.isSchemaRequired("streetAddress")?"":" (Optional)")}get addressCityLabel(){return"City"+(this.isSchemaRequired("addressCity")?"":" (Optional)")}get addressRegionLabel(){let s,t=this.isSchemaRequired("addressRegion");return this.addressLocal.addressCountry==="CA"?(s="Province",t=!0):this.addressLocal.addressCountry==="US"?(s="State",t=!0):s="Province/State",s+(t?"":" (Optional)")}get postalCodeLabel(){let s;return this.addressLocal.addressCountry==="US"?s="Zip Code":s="Postal Code",s+(this.isSchemaRequired("postalCode")?"":" (Optional)")}get addressCountryLabel(){return"Country"+(this.isSchemaRequired("addressCountry")?"":" (Optional)")}get deliveryInstructionsLabel(){return"Delivery Instructions"+(this.isSchemaRequired("deliveryInstructions")?"":" (Optional)")}get streetAddressHint(){return this.noPoBox?"Address cannot be a PO Box":""}isSchemaRequired(s){return!!(this.schemaLocal&&this.schemaLocal[s]&&this.schemaLocal[s].required)}get rules(){return this.createVuetifyRulesObject("addressLocal")}emitAddress(s){}emitValid(s){}onSchemaChanged(){this.schemaLocal={...this.schema}}onAddressChanged(){this.addressLocal={...this.address}}onAddressCountryChanged(){if(this.schema)if(this.useCountryRegions(this.addressLocal.addressCountry)){const s={...this.schema.addressRegion,required:te};this.schemaLocal={...this.schema,addressRegion:s}}else{const{required:s,...t}=this.schema.addressRegion;this.schemaLocal={...this.schema,addressRegion:t}}}onAddressLocalChanged(){this.emitAddress(this.addressLocal),this.emitValid(!this.$v.$invalid)}useCountryRegions(s){return s==="CA"||s==="US"}enableAddressComplete(){const s=window.pca,t=window.addressCompleteKey;if(!s||!t){console.log("AddressComplete not initialized due to missing script and/or key");return}window.currentAddressComplete&&window.currentAddressComplete.destroy(),window.currentAddressComplete=this.createAddressComplete(s,t)}createAddressComplete(s,t){const n=[{element:this.streetAddressId,field:"Line1",mode:s.fieldMode.SEARCH},{element:this.addressCountryId,field:"CountryName",mode:s.fieldMode.COUNTRY}],o={key:t},l=new s.Address(n,o);return l.listen("populate",this.addressCompletePopulate),l}addressCompletePopulate(s){const t={};t.streetAddress=s.Line1||"N/A",t.streetAddressAdditional=this.combineLines(this.combineLines(s.Line2,s.Line3),this.combineLines(s.Line4,s.Line5)),t.addressCity=s.City,this.useCountryRegions(s.CountryIso2)?t.addressRegion=s.ProvinceCode:(t.addressRegion=null,t.streetAddressAdditional=this.combineLines(t.streetAddressAdditional,s.ProvinceName)),t.postalCode=s.PostalCode,t.addressCountry=s.CountryIso2,this.addressLocal=t,ie.nextTick(()=>{this.$refs.addressForm.validate()})}combineLines(s,t){return s?t?s+`
`+t:s:t}};c([hs()],u.prototype,"validations",1);c([h({default:()=>({streetAddress:"",streetAddressAdditional:"",addressCity:"",addressRegion:"",postalCode:"",addressCountry:"",deliveryInstructions:""})})],u.prototype,"address",2);c([h({default:!1})],u.prototype,"editing",2);c([h({default:null})],u.prototype,"schema",2);c([h({default:!1})],u.prototype,"noPoBox",2);c([Y("update:address")],u.prototype,"emitAddress",1);c([Y("valid")],u.prototype,"emitValid",1);c([v("schema",{deep:!0,immediate:!0})],u.prototype,"onSchemaChanged",1);c([v("address",{deep:!0,immediate:!0})],u.prototype,"onAddressChanged",1);c([v("addressCountry")],u.prototype,"onAddressCountryChanged",1);c([v("addressLocal",{deep:!0,immediate:!0})],u.prototype,"onAddressLocalChanged",1);u=c([ue({mixins:[G,J]})],u);var gs=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("div",{staticClass:"base-address"},[s("v-expand-transition",[e.editing?e._e():s("div",{staticClass:"address-block"},[s("div",{staticClass:"address-block__info pre-line"},[s("div",{staticClass:"address-block__info-row street-address"},[e._v(" "+e._s(e.addressLocal.streetAddress)+" ")]),s("div",{staticClass:"address-block__info-row street-address-additional"},[e._v(" "+e._s(e.addressLocal.streetAddressAdditional)+" ")]),s("div",{staticClass:"address-block__info-row"},[s("span",{staticClass:"address-city"},[e._v(e._s(e.addressLocal.addressCity))]),e.addressLocal.addressRegion?[s("span",{staticClass:"address-region"},[e._v(" "+e._s(e.addressLocal.addressRegion))])]:e._e(),e.addressLocal.postalCode?[s("span",{staticClass:"postal-code"},[e._v(" "+e._s(e.addressLocal.postalCode))])]:e._e()],2),s("div",{staticClass:"address-block__info-row address-country"},[e._v(" "+e._s(e.getCountryName(e.addressCountry))+" ")]),e.addressLocal.deliveryInstructions?[s("div",{staticClass:"address-block__info-row delivery-instructions mt-5 font-italic"},[e._v(" "+e._s(e.addressLocal.deliveryInstructions)+" ")])]:e._e()],2)])]),s("v-expand-transition",[e.editing?s("v-form",{ref:"addressForm",attrs:{name:"address-form","lazy-validation":""}},[s("div",{staticClass:"form__row"},[s("v-text-field",{staticClass:"street-address",attrs:{id:e.streetAddressId,autocomplete:"chrome-off",name:Math.random(),filled:"",hint:e.streetAddressHint,"persistent-hint":"",label:e.streetAddressLabel,rules:[...e.rules.streetAddress,...e.spaceRules]},on:{"~keypress":function(t){return e.enableAddressComplete()},click:function(t){return e.enableAddressComplete()}},model:{value:e.addressLocal.streetAddress,callback:function(t){e.$set(e.addressLocal,"streetAddress",t)},expression:"addressLocal.streetAddress"}})],1),s("div",{staticClass:"form__row"},[s("v-textarea",{staticClass:"street-address-additional",attrs:{"auto-grow":"",filled:"",label:e.streetAddressAdditionalLabel,rows:"1",rules:[...e.rules.streetAddressAdditional,...e.spaceRules]},model:{value:e.addressLocal.streetAddressAdditional,callback:function(t){e.$set(e.addressLocal,"streetAddressAdditional",t)},expression:"addressLocal.streetAddressAdditional"}})],1),s("div",{staticClass:"form__row three-column"},[s("v-text-field",{staticClass:"item address-city",attrs:{filled:"",label:e.addressCityLabel,rules:[...e.rules.addressCity,...e.spaceRules]},model:{value:e.addressLocal.addressCity,callback:function(t){e.$set(e.addressLocal,"addressCity",t)},expression:"addressLocal.addressCity"}}),e.useCountryRegions(e.addressCountry)?s("v-select",{staticClass:"item address-region",attrs:{filled:"","menu-props":{maxHeight:"40rem"},label:e.addressRegionLabel,"item-text":"name","item-value":"short",items:e.getCountryRegions(e.addressCountry),rules:[...e.rules.addressRegion,...e.spaceRules]},model:{value:e.addressLocal.addressRegion,callback:function(t){e.$set(e.addressLocal,"addressRegion",t)},expression:"addressLocal.addressRegion"}}):s("v-text-field",{staticClass:"item address-region",attrs:{filled:"",label:e.addressRegionLabel,rules:[...e.rules.addressRegion,...e.spaceRules]},model:{value:e.addressLocal.addressRegion,callback:function(t){e.$set(e.addressLocal,"addressRegion",t)},expression:"addressLocal.addressRegion"}}),s("v-text-field",{staticClass:"item postal-code",attrs:{filled:"",label:e.postalCodeLabel,rules:[...e.rules.postalCode,...e.spaceRules]},model:{value:e.addressLocal.postalCode,callback:function(t){e.$set(e.addressLocal,"postalCode",t)},expression:"addressLocal.postalCode"}})],1),s("div",{staticClass:"form__row"},[s("v-select",{staticClass:"address-country",attrs:{filled:"",label:e.addressCountryLabel,"menu-props":"auto","item-text":"name","item-value":"code",items:e.getCountries(),rules:[...e.rules.addressCountry,...e.spaceRules]},on:{change:function(t){return e.resetRegion()}},model:{value:e.addressLocal.addressCountry,callback:function(t){e.$set(e.addressLocal,"addressCountry",t)},expression:"addressLocal.addressCountry"}}),s("input",{attrs:{id:e.addressCountryId,type:"hidden"},domProps:{value:e.addressCountry}})],1),s("div",{staticClass:"form__row"},[s("v-textarea",{staticClass:"delivery-instructions",attrs:{"auto-grow":"",filled:"",label:e.deliveryInstructionsLabel,rows:"2",rules:[...e.rules.deliveryInstructions,...e.spaceRules]},model:{value:e.addressLocal.deliveryInstructions,callback:function(t){e.$set(e.addressLocal,"deliveryInstructions",t)},expression:"addressLocal.deliveryInstructions"}})],1)]):e._e()],1)],1)},ys=[],ae=ce(u,gs,ys,!1,null,"0f31f2d4",null,null);const Rs=ae.exports;ae.exports.__docgenInfo={description:`The component for displaying and editing an address.
Vuelidate is used to implement the validation rules (eg, what 'required' means and whether it's satisfied).
Vuetify is used to display any validation errors/styling.
Optionally uses Canada Post AddressComplete (aka Postal Code Anywhere - PCA) for address lookup.`,tags:{},exportName:"default",displayName:"BaseAddress",props:[{name:"address",tags:{},description:`The address to be displayed/edited.
Default is "empty address" in case parent doesn't provide it (eg, for new address).`,type:{name:"object"},defaultValue:{func:!0,value:`() => ({\r
  streetAddress: '',\r
  streetAddressAdditional: '',\r
  addressCity: '',\r
  addressRegion: '',\r
  postalCode: '',\r
  addressCountry: '',\r
  deliveryInstructions: ''\r
})`}},{name:"editing",tags:{},description:"Whether the address should be shown in editing mode (true) or display mode (false).",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"schema",tags:{},description:"The address schema containing Vuelidate rules.",type:{name:"any"},defaultValue:{func:!1,value:"null"}},{name:"noPoBox",tags:{},type:{name:"boolean"},defaultValue:{func:!1,value:"false"}}],events:[{name:"update:address",description:'Emits an update message for the address prop, so that the caller can ".sync" with it.'},{name:"valid",description:"Emits the validity of the address entered by the user."}],sourceFiles:["C:/Users/kjazzar/Downloads/repos/bcrs-shared-components/src/components/base-address/BaseAddress.vue","C:\\Users\\kjazzar\\Downloads\\repos\\bcrs-shared-components\\src\\mixins\\countries-provinces-mixin.ts","C:\\Users\\kjazzar\\Downloads\\repos\\bcrs-shared-components\\src\\mixins\\validation-mixin.ts"]};export{Rs as B};
//# sourceMappingURL=BaseAddress-1f5ccaf4.js.map
