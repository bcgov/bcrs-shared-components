var X=Object.defineProperty;var ee=(r,e,s)=>e in r?X(r,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[e]=s;var u=(r,e,s)=>(ee(r,typeof e!="symbol"?e+"":e,s),s);import{V as se}from"./vue.esm-b1e57a2f.js";import{p as te}from"./params-036f571e.js";import{c as re,m as ae,E as W,C as de,P as m,n as ne}from"./_plugin-vue2_normalizer-b11a0120.js";import{W as p}from"./Watch-62f8b699.js";import{l as ie}from"./lodash-f6b38868.js";import{V as K,C as Y}from"./validation-mixin-61dc4f18.js";var a={},A={},d={},L={};Object.defineProperty(L,"__esModule",{value:!0});var oe=te.withParams;L.default=oe;Object.defineProperty(d,"__esModule",{value:!0});d.regex=d.ref=d.len=d.req=d.withParams=void 0;var le=L,G=ue(le);function ue(r){return r&&r.__esModule?r:{default:r}}d.withParams=G.default;var ce=d.req=function(e){if(Array.isArray(e))return!!e.length;if(e==null||e===!1)return!1;if(e instanceof Date)return!isNaN(e.getTime());if(typeof e=="object"){for(var s in e)return!0;return!1}return!!String(e).length};d.len=function(e){return Array.isArray(e)?e.length:typeof e=="object"?Object.keys(e).length:String(e).length};d.ref=function(e,s,t){return typeof e=="function"?e.call(s,t):t[e]};d.regex=function(e,s){return(0,G.default)({type:e},function(t){return!ce(t)||s.test(t)})};Object.defineProperty(A,"__esModule",{value:!0});var fe=d;A.default=(0,fe.regex)("alpha",/^[a-zA-Z]*$/);var b={};Object.defineProperty(b,"__esModule",{value:!0});var me=d;b.default=(0,me.regex)("alphaNum",/^[a-zA-Z0-9]*$/);var x={};Object.defineProperty(x,"__esModule",{value:!0});var pe=d;x.default=(0,pe.regex)("numeric",/^[0-9]*$/);var P={};Object.defineProperty(P,"__esModule",{value:!0});var z=d;P.default=function(r,e){return(0,z.withParams)({type:"between",min:r,max:e},function(s){return!(0,z.req)(s)||(!/\s/.test(s)||s instanceof Date)&&+r<=+s&&+e>=+s})};var w={};Object.defineProperty(w,"__esModule",{value:!0});var he=d,ve=/(^$|^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$)/;w.default=(0,he.regex)("email",ve);var R={};Object.defineProperty(R,"__esModule",{value:!0});var U=d;R.default=(0,U.withParams)({type:"ipAddress"},function(r){if(!(0,U.req)(r))return!0;if(typeof r!="string")return!1;var e=r.split(".");return e.length===4&&e.every(_e)});var _e=function(e){if(e.length>3||e.length===0||e[0]==="0"&&e!=="0"||!e.match(/^\d+$/))return!1;var s=+e|0;return s>=0&&s<=255},q={};Object.defineProperty(q,"__esModule",{value:!0});var D=d;q.default=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:":";return(0,D.withParams)({type:"macAddress"},function(e){if(!(0,D.req)(e))return!0;if(typeof e!="string")return!1;var s=typeof r=="string"&&r!==""?e.split(r):e.length===12||e.length===16?e.match(/.{2}/g):null;return s!==null&&(s.length===6||s.length===8)&&s.every(ye)})};var ye=function(e){return e.toLowerCase().match(/^[0-9a-f]{2}$/)},$={};Object.defineProperty($,"__esModule",{value:!0});var _=d;$.default=function(r){return(0,_.withParams)({type:"maxLength",max:r},function(e){return!(0,_.req)(e)||(0,_.len)(e)<=r})};var I={};Object.defineProperty(I,"__esModule",{value:!0});var y=d;I.default=function(r){return(0,y.withParams)({type:"minLength",min:r},function(e){return!(0,y.req)(e)||(0,y.len)(e)>=r})};var V={};Object.defineProperty(V,"__esModule",{value:!0});var T=d;V.default=(0,T.withParams)({type:"required"},T.req);var O={};Object.defineProperty(O,"__esModule",{value:!0});var C=d;O.default=function(r){return(0,C.withParams)({type:"requiredIf",prop:r},function(e,s){return(0,C.ref)(r,this,s)?(0,C.req)(e):!0})};var M={};Object.defineProperty(M,"__esModule",{value:!0});var g=d;M.default=function(r){return(0,g.withParams)({type:"requiredUnless",prop:r},function(e,s){return(0,g.ref)(r,this,s)?!0:(0,g.req)(e)})};var S={};Object.defineProperty(S,"__esModule",{value:!0});var k=d;S.default=function(r){return(0,k.withParams)({type:"sameAs",eq:r},function(e,s){return e===(0,k.ref)(r,this,s)})};var j={};Object.defineProperty(j,"__esModule",{value:!0});var Ce=d,ge=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i;j.default=(0,Ce.regex)("url",ge);var B={};Object.defineProperty(B,"__esModule",{value:!0});var Ae=d;B.default=function(){for(var r=arguments.length,e=Array(r),s=0;s<r;s++)e[s]=arguments[s];return(0,Ae.withParams)({type:"or"},function(){for(var t=this,n=arguments.length,f=Array(n),i=0;i<n;i++)f[i]=arguments[i];return e.length>0&&e.reduce(function(h,v){return h||v.apply(t,f)},!1)})};var N={};Object.defineProperty(N,"__esModule",{value:!0});var Le=d;N.default=function(){for(var r=arguments.length,e=Array(r),s=0;s<r;s++)e[s]=arguments[s];return(0,Le.withParams)({type:"and"},function(){for(var t=this,n=arguments.length,f=Array(n),i=0;i<n;i++)f[i]=arguments[i];return e.length>0&&e.reduce(function(h,v){return h&&v.apply(t,f)},!0)})};var E={};Object.defineProperty(E,"__esModule",{value:!0});var Z=d;E.default=function(r){return(0,Z.withParams)({type:"minValue",min:r},function(e){return!(0,Z.req)(e)||(!/\s/.test(e)||e instanceof Date)&&+e>=+r})};var F={};Object.defineProperty(F,"__esModule",{value:!0});var H=d;F.default=function(r){return(0,H.withParams)({type:"maxValue",max:r},function(e){return!(0,H.req)(e)||(!/\s/.test(e)||e instanceof Date)&&+e<=+r})};Object.defineProperty(a,"__esModule",{value:!0});a.maxValue=a.minValue=a.and=a.or=a.url=a.sameAs=a.requiredUnless=a.requiredIf=J=a.required=a.minLength=ds=a.maxLength=a.macAddress=a.ipAddress=a.email=a.between=a.numeric=a.alphaNum=a.alpha=void 0;var be=A,xe=o(be),Pe=b,we=o(Pe),Re=x,qe=o(Re),$e=P,Ie=o($e),Ve=w,Oe=o(Ve),Me=R,Se=o(Me),je=q,Be=o(je),Ne=$,Ee=o(Ne),Fe=I,ze=o(Fe),Ue=V,De=o(Ue),Te=O,ke=o(Te),Ze=M,He=o(Ze),We=S,Ke=o(We),Ye=j,Ge=o(Ye),Je=B,Qe=o(Je),Xe=N,es=o(Xe),ss=E,ts=o(ss),rs=F,as=o(rs);function o(r){return r&&r.__esModule?r:{default:r}}a.alpha=xe.default;a.alphaNum=we.default;a.numeric=qe.default;a.between=Ie.default;a.email=Oe.default;a.ipAddress=Se.default;a.macAddress=Be.default;var ds=a.maxLength=Ee.default;a.minLength=ze.default;var J=a.required=De.default;a.requiredIf=ke.default;a.requiredUnless=He.default;a.sameAs=Ke.default;a.url=Ge.default;a.or=Qe.default;a.and=es.default;a.minValue=ts.default;a.maxValue=as.default;const ns=function(){const r=this.$vnode.componentOptions.Ctor.options.__validations||{},e={};for(const s in r){if(!r.hasOwnProperty(s))continue;let t=r[s];s==="__validations__"&&(t=this[t]),typeof t=="function"&&(t=t.call(this)),s==="__validations__"?Object.assign(e,t):e[s]=t}return e};function is(){return re((r,e)=>{r.__validations||(r.__validations={}),r.__validations.__validations__=e,r.validations=ns})}var os=Object.defineProperty,ls=Object.getOwnPropertyDescriptor,c=(r,e,s,t)=>{for(var n=t>1?void 0:t?ls(e,s):e,f=r.length-1,i;f>=0;f--)(i=r[f])&&(n=(t?i(e,s,n):i(n))||n);return t&&n&&os(e,s,n),n};let l=class extends ae(K,Y){constructor(){super(...arguments);u(this,"$refs");u(this,"address");u(this,"editing");u(this,"schema");u(this,"noPoBox");u(this,"deliveryInstructionsText");u(this,"excludeBC");u(this,"isInactive");u(this,"addressLocal",{});u(this,"schemaLocal",{});u(this,"uniqueId",ie.uniqueId());u(this,"addressFormValid",!0);u(this,"postalCodeRulesEnabled",!1);u(this,"spaceRules",[s=>!/^\s/g.test(s)||"Invalid spaces",s=>!/\s$/g.test(s)||"Invalid spaces",s=>!/\s\s/g.test(s)||"Invalid word spacing"])}validations(){return{addressLocal:{...this.schemaLocal}}}validate(){return this.postalCodeRulesEnabled=!0,this.$refs.addressForm.validate()}reset(){return this.postalCodeRulesEnabled=!1,this.$refs.addressForm.reset()}resetValidation(){return this.$refs.addressForm.resetValidation()}onCountryChange(){this.addressLocal.addressRegion="",this.addressLocal.postalCode="",this.resetValidation()}created(){this.onAddressCountryChanged()}get streetAddressId(){return`street-address-${this.uniqueId}`}get addressCountryId(){return`address-country-${this.uniqueId}`}get addressCountry(){return this.addressLocal.addressCountry}get isAddressCountryCanadaAndExcludeBc(){return this.addressLocal.addressCountry==="CA"&&this.excludeBC}get streetAddressAdditionalLabel(){return"Additional Street Address"+(this.isSchemaRequired("streetAddressAdditional")?"":" (Optional)")}get streetAddressLabel(){return"Street Address"+(this.isSchemaRequired("streetAddress")?"":" (Optional)")}get addressCityLabel(){return"City"+(this.isSchemaRequired("addressCity")?"":" (Optional)")}get addressRegionLabel(){let s,t=this.isSchemaRequired("addressRegion");return this.addressLocal.addressCountry==="CA"?(s="Province",t=!0):this.addressLocal.addressCountry==="US"?(s="State",t=!0):s="Province/State",s+(t?"":" (Optional)")}get postalCodeLabel(){let s;return this.addressLocal.addressCountry==="US"?s="Zip Code":s="Postal Code",s+(this.isSchemaRequired("postalCode")?"":" (Optional)")}get addressCountryLabel(){return"Country"+(this.isSchemaRequired("addressCountry")?"":" (Optional)")}get deliveryInstructionsLabel(){return this.deliveryInstructionsText?this.deliveryInstructionsText+(this.isSchemaRequired("deliveryInstructions")?"":" (Optional)"):"Delivery Instructions"+(this.isSchemaRequired("deliveryInstructions")?"":" (Optional)")}get streetAddressHint(){return this.noPoBox?"Address cannot be a PO Box":""}isSchemaRequired(s){return!!(this.schemaLocal&&this.schemaLocal[s]&&this.schemaLocal[s].required)}get rules(){return this.createVuetifyRulesObject("addressLocal")}onSchemaChanged(){this.schemaLocal={...this.schema}}onAddressChanged(){this.addressLocal={...this.address}}onAddressCountryChanged(){if(this.schema)if(this.useCountryRegions(this.addressLocal.addressCountry)){const s={...this.schema.addressRegion,required:J};this.schemaLocal={...this.schema,addressRegion:s}}else{const{required:s,...t}=this.schema.addressRegion;this.schemaLocal={...this.schema,addressRegion:t}}}onAddressLocalChanged(){return this.addressLocal}onAddressFormValidChanged(){return this.addressFormValid&&this.postalCodeRulesEnabled}useCountryRegions(s){return s==="CA"||s==="US"}enableAddressComplete(){const s=window.pca,t=window.addressCompleteKey;if(!s||!t){console.log("AddressComplete not initialized due to missing script and/or key");return}window.currentAddressComplete&&window.currentAddressComplete.destroy(),window.currentAddressComplete=this.createAddressComplete(s,t)}createAddressComplete(s,t){const n=[{element:this.streetAddressId,field:"Line1",mode:s.fieldMode.SEARCH},{element:this.addressCountryId,field:"CountryName",mode:s.fieldMode.COUNTRY}],f={key:t,bar:{visible:!1}},i=new s.Address(n,f);return i.listen("populate",this.addressCompletePopulate),i}addressCompletePopulate(s){const t={};t.streetAddress=s.Line1||"N/A",t.streetAddressAdditional=this.combineLines(this.combineLines(s.Line2,s.Line3),this.combineLines(s.Line4,s.Line5)),t.addressCity=s.City,this.useCountryRegions(s.CountryIso2)?t.addressRegion=s.ProvinceCode:(t.addressRegion=null,t.streetAddressAdditional=this.combineLines(t.streetAddressAdditional,s.ProvinceName)),t.postalCode=s.PostalCode,t.addressCountry=s.CountryIso2,this.addressLocal=t,se.nextTick(()=>this.validate())}getCountriesList(){const s=this.getCountries(),t=["Canada","United States of America"],n=s.filter(i=>t.includes(i.name)),f=s.filter(i=>!t.includes(i.name));return[...n,{divider:!0},...f]}combineLines(s,t){return s?t?s+`
`+t:s:t}};c([is()],l.prototype,"validations",1);c([m({default:()=>({streetAddress:"",streetAddressAdditional:"",addressCity:"",addressRegion:"",postalCode:"",addressCountry:"CA",deliveryInstructions:""})})],l.prototype,"address",2);c([m({default:!1})],l.prototype,"editing",2);c([m({default:null})],l.prototype,"schema",2);c([m({default:!1})],l.prototype,"noPoBox",2);c([m({default:""})],l.prototype,"deliveryInstructionsText",2);c([m({default:!1})],l.prototype,"excludeBC",2);c([m({default:!1})],l.prototype,"isInactive",2);c([p("schema",{deep:!0,immediate:!0})],l.prototype,"onSchemaChanged",1);c([p("address",{deep:!0,immediate:!0})],l.prototype,"onAddressChanged",1);c([p("addressCountry")],l.prototype,"onAddressCountryChanged",1);c([p("addressLocal",{deep:!0,immediate:!0}),W("update:address")],l.prototype,"onAddressLocalChanged",1);c([p("addressFormValid"),p("postalCodeRulesEnabled"),W("valid")],l.prototype,"onAddressFormValidChanged",1);l=c([de({mixins:[K,Y]})],l);var us=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("div",{staticClass:"base-address"},[s("v-expand-transition",[e.editing?e._e():s("div",{staticClass:"address-block",class:{inactive:e.isInactive}},[s("div",{staticClass:"address-block__info pre-line"},[s("div",{staticClass:"address-block__info-row street-address"},[e._v(" "+e._s(e.addressLocal.streetAddress)+" ")]),s("div",{staticClass:"address-block__info-row street-address-additional"},[e._v(" "+e._s(e.addressLocal.streetAddressAdditional)+" ")]),s("div",{staticClass:"address-block__info-row"},[s("span",{staticClass:"address-city"},[e._v(e._s(e.addressLocal.addressCity))]),e.addressLocal.addressRegion?[s("span",{staticClass:"address-region"},[e._v(" "+e._s(e.addressLocal.addressRegion))])]:e._e(),e.addressLocal.postalCode?[s("span",{staticClass:"postal-code"},[e._v(" "+e._s(e.addressLocal.postalCode))])]:e._e()],2),s("div",{staticClass:"address-block__info-row address-country"},[e._v(" "+e._s(e.getCountryName(e.addressCountry))+" ")]),e.addressLocal.deliveryInstructions?[s("div",{staticClass:"address-block__info-row delivery-instructions mt-5 font-italic"},[e._v(" "+e._s(e.addressLocal.deliveryInstructions)+" ")])]:e._e()],2)])]),s("v-expand-transition",[e.editing?s("v-form",{ref:"addressForm",attrs:{name:"address-form","lazy-validation":""},model:{value:e.addressFormValid,callback:function(t){e.addressFormValid=t},expression:"addressFormValid"}},[s("div",{staticClass:"form__row"},[s("v-select",{staticClass:"address-country",attrs:{filled:"",label:e.addressCountryLabel,"menu-props":"auto","item-text":"name","item-value":"code",items:e.getCountriesList(),rules:[...e.rules.addressCountry,...e.spaceRules]},on:{change:function(t){return e.onCountryChange()}},model:{value:e.addressLocal.addressCountry,callback:function(t){e.$set(e.addressLocal,"addressCountry",t)},expression:"addressLocal.addressCountry"}}),s("input",{attrs:{id:e.addressCountryId,type:"hidden"},domProps:{value:e.addressCountry}})],1),s("div",{staticClass:"form__row"},[s("v-text-field",{staticClass:"street-address",attrs:{id:e.streetAddressId,autocomplete:"chrome-off",name:Math.random(),filled:"",hint:e.streetAddressHint,"persistent-hint":"",label:e.streetAddressLabel,rules:[...e.rules.streetAddress,...e.spaceRules]},on:{"~keypress":function(t){return e.enableAddressComplete()},click:function(t){return e.enableAddressComplete()}},model:{value:e.addressLocal.streetAddress,callback:function(t){e.$set(e.addressLocal,"streetAddress",t)},expression:"addressLocal.streetAddress"}})],1),s("div",{staticClass:"form__row"},[s("v-textarea",{staticClass:"street-address-additional",attrs:{autocomplete:"chrome-off",name:Math.random(),"auto-grow":"",filled:"",label:e.streetAddressAdditionalLabel,rows:"1",rules:[...e.rules.streetAddressAdditional,...e.spaceRules]},model:{value:e.addressLocal.streetAddressAdditional,callback:function(t){e.$set(e.addressLocal,"streetAddressAdditional",t)},expression:"addressLocal.streetAddressAdditional"}})],1),s("div",{staticClass:"form__row three-column"},[s("v-text-field",{staticClass:"item address-city",attrs:{filled:"",label:e.addressCityLabel,rules:[...e.rules.addressCity,...e.spaceRules]},model:{value:e.addressLocal.addressCity,callback:function(t){e.$set(e.addressLocal,"addressCity",t)},expression:"addressLocal.addressCity"}}),e.useCountryRegions(e.addressCountry)?s("v-select",{staticClass:"item address-region",attrs:{filled:"","menu-props":{maxHeight:"40rem"},label:e.addressRegionLabel,"item-text":"name","item-value":"short",items:e.isAddressCountryCanadaAndExcludeBc?e.getCanadaRegionsExcludeBC():e.getCountryRegions(e.addressCountry),rules:[...e.rules.addressRegion,...e.spaceRules]},model:{value:e.addressLocal.addressRegion,callback:function(t){e.$set(e.addressLocal,"addressRegion",t)},expression:"addressLocal.addressRegion"}}):s("v-text-field",{staticClass:"item address-region",attrs:{filled:"",label:e.addressRegionLabel,rules:[...e.rules.addressRegion,...e.spaceRules]},model:{value:e.addressLocal.addressRegion,callback:function(t){e.$set(e.addressLocal,"addressRegion",t)},expression:"addressLocal.addressRegion"}}),s("v-text-field",{staticClass:"item postal-code",attrs:{filled:"",label:e.postalCodeLabel,rules:e.postalCodeRulesEnabled?[...e.rules.postalCode,...e.spaceRules]:[]},on:{input:function(t){var n;e.addressLocal.postalCode=(n=e.addressLocal.postalCode)==null?void 0:n.toUpperCase()},blur:function(t){e.postalCodeRulesEnabled=!0}},model:{value:e.addressLocal.postalCode,callback:function(t){e.$set(e.addressLocal,"postalCode",t)},expression:"addressLocal.postalCode"}})],1),s("div",{staticClass:"form__row"},[s("v-textarea",{staticClass:"delivery-instructions",attrs:{"auto-grow":"",filled:"",label:e.deliveryInstructionsLabel,rows:"2",rules:[...e.rules.deliveryInstructions,...e.spaceRules]},model:{value:e.addressLocal.deliveryInstructions,callback:function(t){e.$set(e.addressLocal,"deliveryInstructions",t)},expression:"addressLocal.deliveryInstructions"}})],1)]):e._e()],1)],1)},cs=[],Q=ne(l,us,cs,!1,null,"500b5bd1",null,null);const gs=Q.exports;Q.exports.__docgenInfo={description:`The component for displaying and editing an address.
Vuelidate is used to implement the validation rules (eg, what 'required' means and whether it's satisfied).
Vuetify is used to display any validation errors/styling.
Optionally uses Canada Post AddressComplete (aka Postal Code Anywhere - PCA) for address lookup.`,tags:{},exportName:"default",displayName:"BaseAddress",props:[{name:"address",tags:{},description:`The address to be displayed/edited.
Default is "empty address" in case parent doesn't provide it (eg, for new address).`,type:{name:"object"},defaultValue:{func:!0,value:`() => ({
  streetAddress: '',
  streetAddressAdditional: '',
  addressCity: '',
  addressRegion: '',
  postalCode: '',
  addressCountry: 'CA',
  deliveryInstructions: ''
})`}},{name:"editing",tags:{},description:"Whether the address should be shown in editing mode (true) or display mode (false).",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"schema",tags:{},description:"The address schema containing Vuelidate rules.",type:{name:"any"},defaultValue:{func:!1,value:"null"}},{name:"noPoBox",tags:{},type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"deliveryInstructionsText",tags:{},type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"excludeBC",tags:{},type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"isInactive",tags:{},type:{name:"boolean"},defaultValue:{func:!1,value:"false"}}],sourceFiles:["/home/severin/repos/bcrs-shared-components/src/components/base-address/BaseAddress.vue","/home/severin/repos/bcrs-shared-components/src/mixins/countries-provinces-mixin.ts","/home/severin/repos/bcrs-shared-components/src/mixins/validation-mixin.ts"]};export{gs as B,ds as m,J as r};
//# sourceMappingURL=BaseAddress-6d0aaa3f.js.map
