{"version":3,"file":"StaffPayment.stories-16a46455.js","sources":["../../src/enums/staff-payment-options.ts","../../src/components/staff-payment/StaffPayment.vue"],"sourcesContent":["export enum StaffPaymentOptions {\r\n    NONE = -1,\r\n    NO_FEE = 0,\r\n    FAS = 1,\r\n    BCOL = 2,\r\n  }\r\n","<template>\r\n  <div id=\"staff-payment-container\">\r\n    <v-row no-gutters>\r\n      <v-col\r\n        v-if=\"displaySideLabel\"\r\n        cols=\"12\"\r\n        sm=\"3\"\r\n        class=\"pr-4 pb-4\"\r\n      >\r\n        <label\r\n          class=\"title-label\"\r\n          :class=\"{'error-text': invalidSection}\"\r\n        >Payment</label>\r\n      </v-col>\r\n\r\n      <v-col\r\n        cols=\"12\"\r\n        :sm=\"displaySideLabel ? 9 : 12\"\r\n      >\r\n        <v-radio-group\r\n          v-model=\"paymentOption\"\r\n          class=\"payment-group\"\r\n        >\r\n          <!-- Cash or Cheque radio button and form -->\r\n          <v-radio\r\n            id=\"fas-radio\"\r\n            class=\"mb-0\"\r\n            label=\"Cash or Cheque\"\r\n            :value=\"StaffPaymentOptions.FAS\"\r\n          />\r\n          <v-form\r\n            ref=\"fasForm\"\r\n            v-model=\"fasFormValid\"\r\n            class=\"mt-4 ml-8\"\r\n          >\r\n            <v-text-field\r\n              id=\"routing-slip-number-textfield\"\r\n              filled\r\n              label=\"Routing Slip Number\"\r\n              :value=\"staffPaymentData.routingSlipNumber\"\r\n              :rules=\"validate ? routingSlipNumberRules : []\"\r\n              :disabled=\"paymentOption === StaffPaymentOptions.BCOL || paymentOption === StaffPaymentOptions.NO_FEE\"\r\n              @keyup=\"staffPaymentData.routingSlipNumber = staffPaymentData.routingSlipNumber.trim()\"\r\n              @focus=\"paymentOption = StaffPaymentOptions.FAS\"\r\n              @input=\"emitStaffPaymentData({ option: StaffPaymentOptions.FAS, routingSlipNumber: $event })\"\r\n            />\r\n          </v-form>\r\n\r\n          <!-- BC Online radio button and form -->\r\n          <v-radio\r\n            id=\"bcol-radio\"\r\n            class=\"mb-0 pt-2\"\r\n            label=\"BC Online\"\r\n            :value=\"StaffPaymentOptions.BCOL\"\r\n          />\r\n          <v-form\r\n            ref=\"bcolForm\"\r\n            v-model=\"bcolFormValid\"\r\n            class=\"mt-4 ml-8\"\r\n          >\r\n            <v-text-field\r\n              id=\"bcol-account-number-textfield\"\r\n              filled\r\n              label=\"BC Online Account Number\"\r\n              :value=\"staffPaymentData.bcolAccountNumber\"\r\n              :rules=\"validate ? bcolAccountNumberRules : []\"\r\n              :disabled=\"paymentOption === StaffPaymentOptions.FAS || paymentOption === StaffPaymentOptions.NO_FEE\"\r\n              @keyup=\"staffPaymentData.bcolAccountNumber = staffPaymentData.bcolAccountNumber.trim()\"\r\n              @focus=\"paymentOption = StaffPaymentOptions.BCOL\"\r\n              @input=\"emitStaffPaymentData({ option: StaffPaymentOptions.BCOL, bcolAccountNumber: $event })\"\r\n            />\r\n            <v-text-field\r\n              id=\"dat-number-textfield\"\r\n              filled\r\n              label=\"DAT Number\"\r\n              :value=\"staffPaymentData.datNumber\"\r\n              :rules=\"validate ? datNumberRules : []\"\r\n              :disabled=\"paymentOption === StaffPaymentOptions.FAS || paymentOption === StaffPaymentOptions.NO_FEE\"\r\n              @keyup=\"staffPaymentData.datNumber = staffPaymentData.datNumber.trim()\"\r\n              @focus=\"paymentOption = StaffPaymentOptions.BCOL\"\r\n              @input=\"emitStaffPaymentData({ option: StaffPaymentOptions.BCOL, datNumber: $event })\"\r\n            />\r\n            <FolioNumberInput\r\n              ref=\"folioNumberInputRef\"\r\n              :folioNumber=\"staffPaymentData.folioNumber\"\r\n              :disabled=\"paymentOption === StaffPaymentOptions.FAS || paymentOption === StaffPaymentOptions.NO_FEE\"\r\n              validate=\"true\"\r\n              @focus=\"paymentOption = StaffPaymentOptions.BCOL\"\r\n              @emitFolioNumber=\"paymentOption === StaffPaymentOptions.BCOL &&\r\n                emitStaffPaymentData({ option: StaffPaymentOptions.BCOL, folioNumber: $event })\"\r\n            />\r\n          </v-form>\r\n\r\n          <!-- No Fee radio button -->\r\n          <v-radio\r\n            id=\"no-fee-radio\"\r\n            class=\"mb-0 pt-2\"\r\n            label=\"No Fee\"\r\n            :value=\"StaffPaymentOptions.NO_FEE\"\r\n          />\r\n\r\n          <template v-if=\"displayPriorityCheckbox\">\r\n            <v-divider class=\"mt-6\" />\r\n\r\n            <!-- Priority checkbox -->\r\n            <v-checkbox\r\n              id=\"priority-checkbox\"\r\n              class=\"priority-checkbox mt-6 pt-0\"\r\n              label=\"Priority (add $100.00)\"\r\n              hide-details\r\n              :input-value=\"staffPaymentData.isPriority\"\r\n              :disabled=\"paymentOption === StaffPaymentOptions.NO_FEE\"\r\n              @change=\"emitStaffPaymentData({ isPriority: !!$event })\"\r\n            />\r\n          </template>\r\n        </v-radio-group>\r\n      </v-col>\r\n    </v-row>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport Vue from 'vue'\r\nimport { Component, Prop, Watch, Emit } from 'vue-property-decorator'\r\nimport { StaffPaymentOptions } from '@bcrs-shared-components/enums'\r\nimport { FolioNumberInput } from '@bcrs-shared-components/folio-number-input'\r\nimport { FormIF, StaffPaymentIF } from '@bcrs-shared-components/interfaces'\r\n\r\n@Component({\r\n  components: { FolioNumberInput }\r\n})\r\nexport default class StaffPayment extends Vue {\r\n  // To fix \"property X does not exist on type Y\" errors, annotate types for referenced components.\r\n  // ref: https://github.com/vuejs/vetur/issues/1414\r\n  // ref: https://github.com/vuejs/vue-class-component/issues/94\r\n  $refs!: Vue['$refs'] & {\r\n    fasForm: FormIF,\r\n    bcolForm: FormIF,\r\n    folioNumberInputRef: FolioNumberInput\r\n  }\r\n\r\n  /** Enum for template. */\r\n  readonly StaffPaymentOptions = StaffPaymentOptions\r\n\r\n  /** Whether to display side label. */\r\n  @Prop({ default: true }) readonly displaySideLabel!: boolean\r\n\r\n  /** Whether to display priority checkbox. */\r\n  @Prop({ default: true }) readonly displayPriorityCheckbox!: boolean\r\n\r\n  /** Whether to validate the fields. */\r\n  @Prop({ default: false }) readonly validate!: boolean\r\n\r\n  /** Whether to show invalid section styling (label only). */\r\n  @Prop({ default: false }) readonly invalidSection!: boolean\r\n\r\n  /** Staff Payment Data prop. */\r\n  @Prop({\r\n    default: () => {\r\n      return {\r\n        option: StaffPaymentOptions.NONE,\r\n        routingSlipNumber: null,\r\n        bcolAccountNumber: null,\r\n        datNumber: null,\r\n        folioNumber: null,\r\n        isPriority: false\r\n      }\r\n    }\r\n  })\r\n  readonly staffPaymentData!: StaffPaymentIF\r\n\r\n  /** Radio group model property. */\r\n  private paymentOption = StaffPaymentOptions.NONE\r\n\r\n  /** FAS form model property. */\r\n  private fasFormValid = false\r\n\r\n  /** BCOL form model property. */\r\n  private bcolFormValid = false\r\n\r\n  /** Whether this component has been mounted. */\r\n  private isMounted = false\r\n\r\n  /** Validation rules for Routing Slip Number. */\r\n  readonly routingSlipNumberRules: Array<(v) => boolean | string> = [\r\n    v => !!v || 'Enter FAS Routing Slip Number',\r\n    v => /^\\d{9}$/.test(v) || 'Routing Slip Number must be 9 digits'\r\n  ]\r\n\r\n  /** Validation rules for BCOL Account Number. */\r\n  readonly bcolAccountNumberRules: Array<(v) => boolean | string> = [\r\n    v => !!v || 'Enter BC Online Account Number',\r\n    v => /^\\d{6}$/.test(v) || 'BC Online Account Number must be 6 digits'\r\n  ]\r\n\r\n  /** Validation rules for DAT Number. */\r\n  readonly datNumberRules: Array<(v) => boolean | string> = [\r\n    v => !!v || 'Enter DAT Number',\r\n    v => /^[A-Z]{1}[0-9]{7,9}$/.test(v) || 'DAT Number must be in standard format (eg, C1234567)'\r\n  ]\r\n\r\n  /** Called when component is mounted. */\r\n  async mounted (): Promise<void> {\r\n    await this.$nextTick()\r\n    this.isMounted = true\r\n  }\r\n\r\n  /** Called when payment option (radio group item) has changed. */\r\n  @Watch('paymentOption')\r\n  private onPaymentOptionChanged (val: number): void {\r\n    switch (val) {\r\n      case StaffPaymentOptions.FAS:\r\n        // reset other form\r\n        this.$refs.bcolForm.resetValidation()\r\n        this.$refs.folioNumberInputRef.resetFolioNumberValidation()\r\n        // enable validation for this form\r\n        this.$refs.fasForm.validate()\r\n        // update data\r\n        this.emitStaffPaymentData({ option: StaffPaymentOptions.FAS })\r\n        break\r\n\r\n      case StaffPaymentOptions.BCOL:\r\n        // reset other form\r\n        this.$refs.fasForm.resetValidation()\r\n        // enable validation for this form\r\n        this.$refs.bcolForm.validate()\r\n        // update data\r\n        this.emitStaffPaymentData({ option: StaffPaymentOptions.BCOL })\r\n        break\r\n\r\n      case StaffPaymentOptions.NO_FEE:\r\n        // reset other forms\r\n        this.$refs.fasForm.resetValidation()\r\n        this.$refs.bcolForm.resetValidation()\r\n        this.$refs.folioNumberInputRef.resetFolioNumberValidation()\r\n        // update data\r\n        this.emitStaffPaymentData({ option: StaffPaymentOptions.NO_FEE, isPriority: false })\r\n        break\r\n    }\r\n  }\r\n\r\n  /** Watches for change to FAS form validity. */\r\n  @Watch('fasFormValid')\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  private onFasFormValid (val: boolean) {\r\n    // ignore initial condition\r\n    if (!this.isMounted) return\r\n    this.emitValid()\r\n  }\r\n\r\n  /** Watches for change to BCOL form validity. */\r\n  @Watch('bcolFormValid')\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  private onBcolFormValid (val: boolean) {\r\n    // ignore initial condition\r\n    if (!this.isMounted) return\r\n    this.emitValid()\r\n  }\r\n\r\n  /** Watches for changes to Staff Payment Data prop. */\r\n  @Watch('staffPaymentData', { deep: true, immediate: true })\r\n  private async onStaffPaymentDataChanged (val: StaffPaymentIF): Promise<void> {\r\n    this.paymentOption = val.option\r\n    await this.$nextTick()\r\n    this.emitValid()\r\n  }\r\n\r\n  /** Emits an event to update the Staff Payment Data prop. */\r\n  @Emit('update:staffPaymentData')\r\n  private emitStaffPaymentData ({\r\n    option = this.staffPaymentData.option,\r\n    routingSlipNumber = this.staffPaymentData.routingSlipNumber || '',\r\n    bcolAccountNumber = this.staffPaymentData.bcolAccountNumber || '',\r\n    datNumber = this.staffPaymentData.datNumber || '',\r\n    folioNumber = this.staffPaymentData.folioNumber || '',\r\n    isPriority = this.staffPaymentData.isPriority || false\r\n  }): StaffPaymentIF {\r\n    // return only the appropriate fields for each option\r\n    switch (option) {\r\n      case StaffPaymentOptions.FAS:\r\n        return { option, routingSlipNumber, isPriority } as StaffPaymentIF\r\n\r\n      case StaffPaymentOptions.BCOL:\r\n        return { option, bcolAccountNumber, datNumber, folioNumber, isPriority } as StaffPaymentIF\r\n\r\n      case StaffPaymentOptions.NO_FEE:\r\n        return { option } as StaffPaymentIF\r\n    }\r\n  }\r\n\r\n  /** Emits an event indicating whether or not this component is valid. */\r\n  @Emit('valid')\r\n  private emitValid (): boolean {\r\n    return (this.fasFormValid ||\r\n      (this.bcolFormValid && this.$refs.folioNumberInputRef.validateFolioNumber()) ||\r\n      (this.staffPaymentData.option === StaffPaymentOptions.NO_FEE)\r\n    )\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '@/assets/styles/theme.scss';\r\n\r\n#staff-payment-container {\r\n  line-height: 1.2rem;\r\n  font-size: $px-16;\r\n}\r\n\r\n.title-label {\r\n  font-weight: bold;\r\n  color: $gray9;\r\n}\r\n\r\n.payment-container {\r\n  > label:first-child {\r\n    font-weight: 700;\r\n    margin-bottom: 2rem;\r\n  }\r\n}\r\n\r\n.payment-group {\r\n  margin-top: 0;\r\n  padding-top: 0;\r\n\r\n  :deep(> .v-input__control) {\r\n    margin-bottom: -12px;\r\n  }\r\n}\r\n\r\n// override Vuetify label colors\r\n:deep() {\r\n  .v-input--selection-controls__ripple,\r\n  .v-text-field__slot .v-label,\r\n  .v-radio .v-label,\r\n  .v-input--checkbox .v-label {\r\n    color: $gray7 !important;\r\n  }\r\n}\r\n</style>\r\n"],"names":["StaffPaymentOptions","StaffPayment","Vue","__publicField","v","val","option","routingSlipNumber","bcolAccountNumber","datNumber","folioNumber","isPriority","__decorateClass","Prop","Watch","Emit","Component","FolioNumberInput"],"mappings":"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"}