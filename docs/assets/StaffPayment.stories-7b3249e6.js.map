{"version":3,"file":"StaffPayment.stories-7b3249e6.js","sources":["../../src/enums/staff-payment-options.ts","../../src/components/staff-payment/StaffPayment.vue"],"sourcesContent":["export enum StaffPaymentOptions {\n    NONE = -1,\n    NO_FEE = 0,\n    FAS = 1,\n    BCOL = 2,\n  }\n","<template>\n  <div id=\"staff-payment-container\">\n    <v-row no-gutters>\n      <v-col\n        v-if=\"displaySideLabel\"\n        cols=\"12\"\n        sm=\"3\"\n        class=\"pr-4 pb-4\"\n      >\n        <label\n          class=\"title-label\"\n          :class=\"{'error-text': invalidSection}\"\n        >Payment</label>\n      </v-col>\n\n      <v-col\n        cols=\"12\"\n        :sm=\"displaySideLabel ? 9 : 12\"\n      >\n        <v-radio-group\n          v-model=\"paymentOption\"\n          class=\"payment-group\"\n        >\n          <!-- Cash or Cheque radio button and form -->\n          <v-radio\n            id=\"fas-radio\"\n            class=\"mb-0\"\n            label=\"Cash or Cheque\"\n            :value=\"StaffPaymentOptions.FAS\"\n          />\n          <v-form\n            ref=\"fasForm\"\n            v-model=\"fasFormValid\"\n            class=\"mt-4 ml-8\"\n          >\n            <v-text-field\n              id=\"routing-slip-number-textfield\"\n              filled\n              label=\"Routing Slip Number\"\n              :value=\"staffPaymentData.routingSlipNumber\"\n              :rules=\"validate ? routingSlipNumberRules : []\"\n              :disabled=\"paymentOption === StaffPaymentOptions.BCOL || paymentOption === StaffPaymentOptions.NO_FEE\"\n              @keyup=\"staffPaymentData.routingSlipNumber = staffPaymentData.routingSlipNumber.trim()\"\n              @focus=\"paymentOption = StaffPaymentOptions.FAS\"\n              @input=\"emitStaffPaymentData({ option: StaffPaymentOptions.FAS, routingSlipNumber: $event })\"\n            />\n          </v-form>\n\n          <!-- BC Online radio button and form -->\n          <v-radio\n            id=\"bcol-radio\"\n            class=\"mb-0 pt-2\"\n            label=\"BC Online\"\n            :value=\"StaffPaymentOptions.BCOL\"\n          />\n          <v-form\n            ref=\"bcolForm\"\n            v-model=\"bcolFormValid\"\n            class=\"mt-4 ml-8\"\n          >\n            <v-text-field\n              id=\"bcol-account-number-textfield\"\n              filled\n              label=\"BC Online Account Number\"\n              :value=\"staffPaymentData.bcolAccountNumber\"\n              :rules=\"validate ? bcolAccountNumberRules : []\"\n              :disabled=\"paymentOption === StaffPaymentOptions.FAS || paymentOption === StaffPaymentOptions.NO_FEE\"\n              @keyup=\"staffPaymentData.bcolAccountNumber = staffPaymentData.bcolAccountNumber.trim()\"\n              @focus=\"paymentOption = StaffPaymentOptions.BCOL\"\n              @input=\"emitStaffPaymentData({ option: StaffPaymentOptions.BCOL, bcolAccountNumber: $event })\"\n            />\n            <v-text-field\n              id=\"dat-number-textfield\"\n              filled\n              label=\"DAT Number\"\n              :value=\"staffPaymentData.datNumber\"\n              :rules=\"validate ? datNumberRules : []\"\n              :disabled=\"paymentOption === StaffPaymentOptions.FAS || paymentOption === StaffPaymentOptions.NO_FEE\"\n              @keyup=\"staffPaymentData.datNumber = staffPaymentData.datNumber.trim()\"\n              @focus=\"paymentOption = StaffPaymentOptions.BCOL\"\n              @input=\"emitStaffPaymentData({ option: StaffPaymentOptions.BCOL, datNumber: $event })\"\n            />\n            <FolioNumberInput\n              ref=\"folioNumberInputRef\"\n              :folioNumber=\"staffPaymentData.folioNumber\"\n              :disabled=\"paymentOption === StaffPaymentOptions.FAS || paymentOption === StaffPaymentOptions.NO_FEE\"\n              validate=\"true\"\n              @focus=\"paymentOption = StaffPaymentOptions.BCOL\"\n              @emitFolioNumber=\"paymentOption === StaffPaymentOptions.BCOL &&\n                emitStaffPaymentData({ option: StaffPaymentOptions.BCOL, folioNumber: $event })\"\n            />\n          </v-form>\n\n          <!-- No Fee radio button -->\n          <v-radio\n            id=\"no-fee-radio\"\n            class=\"mb-0 pt-2\"\n            label=\"No Fee\"\n            :value=\"StaffPaymentOptions.NO_FEE\"\n          />\n\n          <template v-if=\"displayPriorityCheckbox\">\n            <v-divider class=\"mt-6\" />\n\n            <!-- Priority checkbox -->\n            <v-checkbox\n              id=\"priority-checkbox\"\n              class=\"priority-checkbox mt-6 pt-0\"\n              label=\"Priority (add $100.00)\"\n              hide-details\n              :input-value=\"staffPaymentData.isPriority\"\n              :disabled=\"paymentOption === StaffPaymentOptions.NO_FEE\"\n              @change=\"emitStaffPaymentData({ isPriority: !!$event })\"\n            />\n          </template>\n        </v-radio-group>\n      </v-col>\n    </v-row>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport Vue from 'vue'\nimport { Component, Prop, Watch, Emit } from 'vue-property-decorator'\nimport { StaffPaymentOptions } from '@bcrs-shared-components/enums'\nimport { FolioNumberInput } from '@bcrs-shared-components/folio-number-input'\nimport { FormIF, StaffPaymentIF } from '@bcrs-shared-components/interfaces'\n\n@Component({\n  components: { FolioNumberInput }\n})\nexport default class StaffPayment extends Vue {\n  // To fix \"property X does not exist on type Y\" errors, annotate types for referenced components.\n  // ref: https://github.com/vuejs/vetur/issues/1414\n  // ref: https://github.com/vuejs/vue-class-component/issues/94\n  $refs!: Vue['$refs'] & {\n    fasForm: FormIF,\n    bcolForm: FormIF,\n    folioNumberInputRef: FolioNumberInput\n  }\n\n  /** Enum for template. */\n  readonly StaffPaymentOptions = StaffPaymentOptions\n\n  /** Whether to display side label. */\n  @Prop({ default: true }) readonly displaySideLabel!: boolean\n\n  /** Whether to display priority checkbox. */\n  @Prop({ default: true }) readonly displayPriorityCheckbox!: boolean\n\n  /** Whether to validate the fields. */\n  @Prop({ default: false }) readonly validate!: boolean\n\n  /** Whether to show invalid section styling (label only). */\n  @Prop({ default: false }) readonly invalidSection!: boolean\n\n  /** Staff Payment Data prop. */\n  @Prop({\n    default: () => {\n      return {\n        option: StaffPaymentOptions.NONE,\n        routingSlipNumber: null,\n        bcolAccountNumber: null,\n        datNumber: null,\n        folioNumber: null,\n        isPriority: false\n      }\n    }\n  })\n  readonly staffPaymentData!: StaffPaymentIF\n\n  /** Radio group model property. */\n  private paymentOption = StaffPaymentOptions.NONE\n\n  /** FAS form model property. */\n  private fasFormValid = false\n\n  /** BCOL form model property. */\n  private bcolFormValid = false\n\n  /** Whether this component has been mounted. */\n  private isMounted = false\n\n  /** Validation rules for Routing Slip Number. */\n  readonly routingSlipNumberRules: Array<(v) => boolean | string> = [\n    v => !!v || 'Enter FAS Routing Slip Number',\n    v => /^\\d{9}$/.test(v) || 'Routing Slip Number must be 9 digits'\n  ]\n\n  /** Validation rules for BCOL Account Number. */\n  readonly bcolAccountNumberRules: Array<(v) => boolean | string> = [\n    v => !!v || 'Enter BC Online Account Number',\n    v => /^\\d{6}$/.test(v) || 'BC Online Account Number must be 6 digits'\n  ]\n\n  /** Validation rules for DAT Number. */\n  readonly datNumberRules: Array<(v) => boolean | string> = [\n    v => !!v || 'Enter DAT Number',\n    v => /^[A-Z]{1}[0-9]{7,9}$/.test(v) || 'DAT Number must be in standard format (eg, C1234567)'\n  ]\n\n  /** Called when component is mounted. */\n  async mounted (): Promise<void> {\n    await this.$nextTick()\n    this.isMounted = true\n  }\n\n  /** Called when payment option (radio group item) has changed. */\n  @Watch('paymentOption')\n  private onPaymentOptionChanged (val: number): void {\n    switch (val) {\n      case StaffPaymentOptions.FAS:\n        // reset other form\n        this.$refs.bcolForm.resetValidation()\n        this.$refs.folioNumberInputRef.resetFolioNumberValidation()\n        // enable validation for this form\n        this.$refs.fasForm.validate()\n        // update data\n        this.emitStaffPaymentData({ option: StaffPaymentOptions.FAS })\n        break\n\n      case StaffPaymentOptions.BCOL:\n        // reset other form\n        this.$refs.fasForm.resetValidation()\n        // enable validation for this form\n        this.$refs.bcolForm.validate()\n        // update data\n        this.emitStaffPaymentData({ option: StaffPaymentOptions.BCOL })\n        break\n\n      case StaffPaymentOptions.NO_FEE:\n        // reset other forms\n        this.$refs.fasForm.resetValidation()\n        this.$refs.bcolForm.resetValidation()\n        this.$refs.folioNumberInputRef.resetFolioNumberValidation()\n        // update data\n        this.emitStaffPaymentData({ option: StaffPaymentOptions.NO_FEE, isPriority: false })\n        break\n    }\n  }\n\n  /** Watches for change to FAS form validity. */\n  @Watch('fasFormValid')\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  private onFasFormValid (val: boolean) {\n    // ignore initial condition\n    if (!this.isMounted) return\n    this.emitValid()\n  }\n\n  /** Watches for change to BCOL form validity. */\n  @Watch('bcolFormValid')\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  private onBcolFormValid (val: boolean) {\n    // ignore initial condition\n    if (!this.isMounted) return\n    this.emitValid()\n  }\n\n  /** Watches for changes to Staff Payment Data prop. */\n  @Watch('staffPaymentData', { deep: true, immediate: true })\n  private async onStaffPaymentDataChanged (val: StaffPaymentIF): Promise<void> {\n    this.paymentOption = val.option\n    await this.$nextTick()\n    this.emitValid()\n  }\n\n  /** Emits an event to update the Staff Payment Data prop. */\n  @Emit('update:staffPaymentData')\n  private emitStaffPaymentData ({\n    option = this.staffPaymentData.option,\n    routingSlipNumber = this.staffPaymentData.routingSlipNumber || '',\n    bcolAccountNumber = this.staffPaymentData.bcolAccountNumber || '',\n    datNumber = this.staffPaymentData.datNumber || '',\n    folioNumber = this.staffPaymentData.folioNumber || '',\n    isPriority = this.staffPaymentData.isPriority || false\n  }): StaffPaymentIF {\n    // return only the appropriate fields for each option\n    switch (option) {\n      case StaffPaymentOptions.FAS:\n        return { option, routingSlipNumber, isPriority } as StaffPaymentIF\n\n      case StaffPaymentOptions.BCOL:\n        return { option, bcolAccountNumber, datNumber, folioNumber, isPriority } as StaffPaymentIF\n\n      case StaffPaymentOptions.NO_FEE:\n        return { option } as StaffPaymentIF\n    }\n  }\n\n  /** Emits an event indicating whether or not this component is valid. */\n  @Emit('valid')\n  private emitValid (): boolean {\n    return (this.fasFormValid ||\n      (this.bcolFormValid && this.$refs.folioNumberInputRef.validateFolioNumber()) ||\n      (this.staffPaymentData.option === StaffPaymentOptions.NO_FEE)\n    )\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@import '@/assets/styles/theme.scss';\n\n#staff-payment-container {\n  line-height: 1.2rem;\n  font-size: $px-16;\n}\n\n.title-label {\n  font-weight: bold;\n  color: $gray9;\n}\n\n.payment-container {\n  > label:first-child {\n    font-weight: 700;\n    margin-bottom: 2rem;\n  }\n}\n\n.payment-group {\n  margin-top: 0;\n  padding-top: 0;\n\n  :deep(> .v-input__control) {\n    margin-bottom: -12px;\n  }\n}\n\n// override Vuetify label colors\n:deep() {\n  .v-input--selection-controls__ripple,\n  .v-text-field__slot .v-label,\n  .v-radio .v-label,\n  .v-input--checkbox .v-label {\n    color: $gray7 !important;\n  }\n}\n</style>\n"],"names":["StaffPaymentOptions","StaffPayment","Vue","__publicField","v","val","option","routingSlipNumber","bcolAccountNumber","datNumber","folioNumber","isPriority","__decorateClass","Prop","Watch","Emit","Component","FolioNumberInput"],"mappings":"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"}