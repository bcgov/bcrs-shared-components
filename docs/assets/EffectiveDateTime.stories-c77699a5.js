var _=Object.defineProperty;var x=(n,t,e)=>t in n?_(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var s=(n,t,e)=>(x(n,typeof t!="symbol"?t+"":t,e),e);import{V as v}from"./vue.esm-b1e57a2f.js";import{m as b,C,P as d,E as h,n as I}from"./_plugin-vue2_normalizer-b11a0120.js";import{W as l}from"./Watch-62f8b699.js";import{D as P}from"./DatePicker-ae13b6d5.js";import{D as M}from"./validation-mixin-e5d1d708.js";import{V}from"./vuetify-b9fb25b0.js";import"./lodash-f6b38868.js";import"./_commonjsHelpers-de833af9.js";var m=(n=>(n.FUTURE_EFFECTIVE="futureEffective",n.IMMEDIATE="immediate",n))(m||{}),S=Object.defineProperty,U=Object.getOwnPropertyDescriptor,o=(n,t,e,i)=>{for(var a=i>1?void 0:i?U(t,e):t,c=n.length-1,f;c>=0;c--)(f=n[c])&&(a=(i?f(t,e,a):f(a))||a);return i&&a&&S(t,e,a),a};let r=class extends b(M){constructor(){super(...arguments);s(this,"MIN_DIFF_MINUTES",3);s(this,"MAX_DIFF_DAYS",10);s(this,"$refs");s(this,"parseInitial");s(this,"currentJsDate");s(this,"effectiveDateTime");s(this,"isAppValidate");s(this,"EffectiveDateTypes",m);s(this,"isImmediate",!1);s(this,"isFutureEffective",!1);s(this,"minDate",null);s(this,"maxDate",null);s(this,"effectiveDateType",null);s(this,"datePicker","");s(this,"dateText","");s(this,"selectHour",[]);s(this,"selectMinute",[]);s(this,"selectPeriod","am");s(this,"hours",[...Array(12).keys()].map(e=>(e+1).toString()));s(this,"minutes",[...Array(60).keys()].map(e=>e.toString().padStart(2,"0")));s(this,"timePeriod",["am","pm"])}get dateRules(){if(this.isFutureEffective&&this.isAppValidate){const e=this.dateToPacificDate(this.minDate,!0),i=this.dateToPacificDate(this.maxDate,!0);return[a=>!!a||"Select date",a=>this.isValidDateRange(a)||`Date must be between ${e} and ${i}`]}return[]}isValidDateRange(e){let i=new Date(e);i=new Date(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate());const a=new Date(this.minDate.getFullYear(),this.minDate.getMonth(),this.minDate.getDate()),c=new Date(this.maxDate.getFullYear(),this.maxDate.getMonth(),this.maxDate.getDate());return i>=a&&i<=c}get hourRules(){return this.isFutureEffective&&this.isAppValidate?[e=>e.length>0||"Select hour",e=>/^([1-9]|1[012])$/.test(e)||""]:[]}get minuteRules(){return this.isFutureEffective&&this.isAppValidate?[e=>e.length>0||"Select minute",e=>/^([0-5]?[0-9])$/.test(e)||""]:[]}get isUnderTime(){if(this.effectiveDateTime.effectiveDate){const e=new Date(this.effectiveDateTime.effectiveDate);return e.setSeconds(59,999),e.getTime()<this.minDate.getTime()}return!1}get isOverTime(){if(this.effectiveDateTime.effectiveDate){const e=new Date(this.effectiveDateTime.effectiveDate);return e.setSeconds(0,0),e.getTime()>this.maxDate.getTime()}return!1}mounted(){this.parseInitial&&this.parseInitialEffectiveDateTime()}parseInitialEffectiveDateTime(){this.isFutureEffective=this.effectiveDateTime.isFutureEffective,this.isFutureEffective===!0?this.effectiveDateType=m.FUTURE_EFFECTIVE:this.isFutureEffective===!1?this.effectiveDateType=m.IMMEDIATE:this.effectiveDateType=null;const e=this.effectiveDateTime.effectiveDate,i=e&&new Date(e);if(i){let a=i.getHours();const c=i.getMinutes(),f=a<12?"am":"pm";a>12?a-=12:a===0&&(a=12),this.dateText=this.dateToYyyyMmDd(i),this.selectHour=[a.toString()],this.selectMinute=[c.toString().padStart(2,"0")],this.selectPeriod=f}}async constructAndUpdate(){await v.nextTick();const e=this.$refs.datePickerRef.validateForm(),i=this.$refs.form.validate();if(e&&i&&this.selectHour.length&&this.selectMinute.length){const a=+this.dateText.slice(0,4),c=+this.dateText.slice(5,7)-1,f=+this.dateText.slice(8,10);let p=+this.selectHour;const y=+this.selectMinute;this.selectPeriod==="am"&&+this.selectHour==12&&(p=0),this.selectPeriod==="pm"&&+this.selectHour!=12&&(p+=12);const F=this.createUtcDate(a,c,f,p,y);this.emitEffectiveDate(F)}this.emitValid()}onCurrentJsDateChanged(e){if(e){const i=new Date;i.setTime(e.getTime()+this.MIN_DIFF_MINUTES*60*1e3),this.minDate=i;const a=new Date;a.setTime(e.getTime()+this.MAX_DIFF_DAYS*24*60*60*1e3),this.maxDate=a,this.emitValid()}}onDatePickerChanged(e){this.dateText=e}onDateTextChanged(e){this.isFutureEffective&&this.constructAndUpdate()}onSelectHourChanged(e){this.isFutureEffective&&this.constructAndUpdate()}onSelectMinuteChanged(e){this.isFutureEffective&&this.constructAndUpdate()}onSelectPeriodChanged(e){this.isFutureEffective&&this.constructAndUpdate()}onEffectiveDateTypeChanged(e){this.isImmediate=e===m.IMMEDIATE,this.isFutureEffective=e===m.FUTURE_EFFECTIVE,this.isImmediate&&(this.datePicker="",this.dateText="",this.selectHour=[],this.selectMinute=[],this.selectPeriod="am",this.$refs.datePickerRef.clearDate()),this.emitIsFutureEffective(this.isFutureEffective),this.emitEffectiveDate(null),this.emitValid()}emitIsFutureEffective(e){}emitEffectiveDate(e){}async emitValid(){const e=this.isFutureEffective?!!this.dateText:!0;await v.nextTick();const i=this.$refs.datePickerRef.validateForm(),a=this.$refs.form.validate();return this.isImmediate||!!this.effectiveDateType&&i&&a&&!!this.selectHour.length&&!!this.selectMinute.length&&!this.isUnderTime&&!this.isOverTime&&e}};o([d({default:!1})],r.prototype,"parseInitial",2);o([d()],r.prototype,"currentJsDate",2);o([d()],r.prototype,"effectiveDateTime",2);o([d()],r.prototype,"isAppValidate",2);o([l("currentJsDate",{immediate:!0})],r.prototype,"onCurrentJsDateChanged",1);o([l("datePicker")],r.prototype,"onDatePickerChanged",1);o([l("dateText")],r.prototype,"onDateTextChanged",1);o([l("selectHour")],r.prototype,"onSelectHourChanged",1);o([l("selectMinute")],r.prototype,"onSelectMinuteChanged",1);o([l("selectPeriod")],r.prototype,"onSelectPeriodChanged",1);o([l("effectiveDateType")],r.prototype,"onEffectiveDateTypeChanged",1);o([h("isFutureEffective")],r.prototype,"emitIsFutureEffective",1);o([h("effectiveDate")],r.prototype,"emitEffectiveDate",1);o([h("valid")],r.prototype,"emitValid",1);r=o([C({components:{DatePicker:P}})],r);var w=function(){var t=this,e=t._self._c;return t._self._setupProxy,e("v-card",{attrs:{id:"effective-date-time-box",flat:""}},[e("v-radio-group",{staticClass:"pt-0 mt-0",attrs:{column:""},model:{value:t.effectiveDateType,callback:function(i){t.effectiveDateType=i},expression:"effectiveDateType"}},[e("v-radio",{attrs:{label:"Immediate (date and time of filing)",value:t.EffectiveDateTypes.IMMEDIATE}}),e("v-radio",{attrs:{label:"A date and time in the future",value:t.EffectiveDateTypes.FUTURE_EFFECTIVE}})],1),e("v-form",{ref:"form",staticClass:"date-time-selectors"},[e("DatePicker",{ref:"datePickerRef",attrs:{title:"Date","nudge-right":"40",inputRules:t.dateRules,disablePicker:t.effectiveDateType!==t.EffectiveDateTypes.FUTURE_EFFECTIVE,minDate:t.dateToYyyyMmDd(t.minDate),maxDate:t.dateToYyyyMmDd(t.maxDate)},on:{emitDate:function(i){t.dateText=i},emitCancel:function(i){t.dateText=""}}}),e("v-row",[e("v-col",{attrs:{cols:"12",sm:"6",md:"3"}},[e("v-combobox",{ref:"hourSelector",staticClass:"mr-1",attrs:{id:"hour-selector",filled:"",label:"Hour",items:t.hours,disabled:!t.isFutureEffective,rules:t.hourRules},model:{value:t.selectHour,callback:function(i){t.selectHour=i},expression:"selectHour"}})],1),e("span",{staticClass:"time-colon",class:{disabled:!t.isFutureEffective}},[t._v(":")]),e("v-col",{attrs:{cols:"12",sm:"6",md:"3"}},[e("v-combobox",{ref:"minuteSelector",staticClass:"ml-1",attrs:{id:"minute-selector",filled:"",label:"Minute",items:t.minutes,disabled:!t.isFutureEffective,rules:t.minuteRules},model:{value:t.selectMinute,callback:function(i){t.selectMinute=i},expression:"selectMinute"}})],1),e("v-col",{attrs:{cols:"12",sm:"6",md:"3"}},[e("v-select",{attrs:{id:"period-selector",filled:"",items:t.timePeriod,disabled:!t.isFutureEffective},model:{value:t.selectPeriod,callback:function(i){t.selectPeriod=i},expression:"selectPeriod"}})],1),e("v-col",{staticClass:"label-col",attrs:{cols:"12",sm:"6",md:"3"}},[e("span",{staticClass:"time-zone-label",class:{disabled:!t.isFutureEffective}},[t._v("Pacific time")])])],1),t.isFutureEffective&&t.dateText&&t.selectHour.length>0&&t.selectMinute.length>0?e("v-row",[e("v-col",{staticClass:"validation-alert"},[t.isUnderTime?e("p",{staticClass:"validation-alert-msg"},[t._v(" The time must be at least "+t._s(t.dateToPacificTime(t.minDate))+" for the selected date ")]):t._e(),t.isOverTime?e("p",{staticClass:"validation-alert-msg"},[t._v(" The time must be at most "+t._s(t.dateToPacificTime(t.maxDate))+" for the selected date ")]):t._e()])],1):t._e()],1)],1)},A=[],g=I(r,w,A,!1,null,"8731f544",null,null);const k=g.exports;g.exports.__docgenInfo={description:`This is a local, minimal mixin containing only the methods needed for the shared
components when they run within this project (ie, in Storybook).

When imported into an app project, the shared components should use the mixins
local to that project.`,tags:{},exportName:"default",displayName:"EffectiveDateTime",props:[{name:"parseInitial",tags:{},description:"Whether to parse the initial effective date-time into the controls.",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"currentJsDate",tags:{},description:"Current JS date, expected to be passed in periodically.",type:{name:"Date"}},{name:"effectiveDateTime",tags:{},description:"Effective Date Time object, for initial config.",type:{name:"EffectiveDateTimeIF"}},{name:"isAppValidate",tags:{},description:"Whether to perform validation.",type:{name:"boolean"}}],events:[{name:"isFutureEffective"},{name:"effectiveDate"},{name:"valid"}],sourceFiles:["/Users/work/repos/bcrs-shared-components/src/components/effective-date-time/EffectiveDateTime.vue","/Users/work/repos/bcrs-shared-components/src/mixins/date-mixin.ts"]};const q={title:"component/EffectiveDateTime"},R=(n,{argTypes:t})=>({vuetify:new V({iconfont:"mdi"}),props:Object.keys(t),components:{EffectiveDateTime:k},template:'<effective-date-time v-bind="$props" />'}),u=R.bind({});u.args={parseInitial:!0,currentJsDate:new Date,effectiveDateTime:{valid:!1,isFutureEffective:null,effectiveDate:null},isAppValidate:!1};var D,T,E;u.parameters={...u.parameters,docs:{...(D=u.parameters)==null?void 0:D.docs,source:{originalSource:`(args, {
  argTypes
}) => ({
  vuetify: new Vuetify({
    iconfont: 'mdi'
  }),
  props: Object.keys(argTypes),
  components: {
    EffectiveDateTime
  },
  template: '<effective-date-time v-bind="$props" />' // $props comes from args below
})`,...(E=(T=u.parameters)==null?void 0:T.docs)==null?void 0:E.source}}};const B=["Default"];export{u as Default,B as __namedExportsOrder,q as default};
//# sourceMappingURL=EffectiveDateTime.stories-c77699a5.js.map
