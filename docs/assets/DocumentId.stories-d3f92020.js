var x=Object.defineProperty;var w=(i,e,t)=>e in i?x(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var a=(i,e,t)=>(w(i,typeof e!="symbol"?e+"":e,t),t);import{V as S}from"./vue.esm-b1e57a2f.js";import{a as E}from"./index-28508b38.js";import{C as A,P as m,E as _,n as C}from"./_plugin-vue2_normalizer-b11a0120.js";import{W as p}from"./Watch-62f8b699.js";import{S as f}from"./sbc-common-components-constants-ecf195d0.js";import{V as k}from"./vuetify-b9fb25b0.js";import"./_commonjsHelpers-de833af9.js";var P=Object.defineProperty,T=Object.getOwnPropertyDescriptor,n=(i,e,t,o)=>{for(var r=o>1?void 0:o?T(e,t):e,d=i.length-1,l;d>=0;d--)(l=i[d])&&(r=(o?l(e,t,r):l(r))||r);return o&&r&&P(e,t,r),r};let s=class extends S{constructor(){super(...arguments);a(this,"docApiUrl");a(this,"docApiKey");a(this,"validate");a(this,"cardPadding");a(this,"documentId","");a(this,"isVerifyingDocId",!1);a(this,"isVerifiedDocId",!1);a(this,"generateDocumentId",!1);a(this,"docIdError",[])}get docIdRules(){return[t=>!isNaN(Number(t))||"Must contain numbers only"]}get showBorderError(){return this.validate&&!this.isValidDocumentId}get isValidDocumentId(){return this.isVerifiedDocId||this.generateDocumentId}async fetchDocumentIdStatus(){const t=`${this.docApiUrl}/documents/verify/${this.documentId}`,o={headers:{Authorization:`Bearer ${sessionStorage.getItem(f.KeyCloakToken)}`,"x-apikey":this.docApiKey}},r=sessionStorage.getItem(f.CurrentAccount);if(r){const d=JSON.parse(r);o.headers["Account-Id"]=d.id}try{return(await E.get(t,o)).status}catch(d){if([400,404].includes(d.response.status))return d.response.status}}async onDocumentIdComplete(){var t;if(((t=this.documentId)==null?void 0:t.length)===8){switch(this.isVerifyingDocId=!0,await this.fetchDocumentIdStatus()){case 200:this.docIdError=["Must be unique number"],this.isVerifiedDocId=!1;break;case 400:this.docIdError=["Document ID is invalid"],this.isVerifiedDocId=!1;break;case 404:this.docIdError=null,this.isVerifiedDocId=!0;break;default:this.docIdError=["Document ID request failed"],this.isVerifiedDocId=!1}this.isVerifiedDocId&&this.emitDocumentId(this.documentId)}else this.isVerifiedDocId=!1,this.emitDocumentId("");this.isVerifyingDocId=!1}onGenerateDocumentId(){this.documentId="",this.isVerifyingDocId=!1,this.docIdError=null}onValidationUpdate(){this.emitIsValidDocumentId(!!this.isValidDocumentId)}emitDocumentId(t){return t}emitIsValidDocumentId(t){return t}};n([m({default:!1})],s.prototype,"docApiUrl",2);n([m({default:!1})],s.prototype,"docApiKey",2);n([m({default:!1})],s.prototype,"validate",2);n([m({default:()=>["pt-10 pl-4 pb-3 pr-4"]})],s.prototype,"cardPadding",2);n([p("documentId")],s.prototype,"onDocumentIdComplete",1);n([p("generateDocumentId")],s.prototype,"onGenerateDocumentId",1);n([p("isValidDocumentId")],s.prototype,"onValidationUpdate",1);n([_("updateDocId")],s.prototype,"emitDocumentId",1);n([_("isValid")],s.prototype,"emitIsValidDocumentId",1);s=n([A({})],s);var O=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("v-card",{class:[e.cardPadding,{"border-error-left":e.showBorderError}],attrs:{id:"document-id-card",flat:""}},[t("v-row",{attrs:{"no-gutters":""}},[t("v-col",{attrs:{cols:"12",sm:"3"}},[t("label",{staticClass:"title-label",class:{"error-text":e.showBorderError},attrs:{for:"doc-id-field"}},[e._v(" Document Id ")])]),t("v-col",{attrs:{cols:"12",sm:"9"}},[t("v-text-field",{attrs:{id:"doc-id-field",filled:"",color:"primary",maxlength:"8",label:"Document ID Number",rules:e.docIdRules,disabled:e.generateDocumentId,error:!e.isVerifiedDocId&&e.validate&&!e.generateDocumentId,"error-messages":e.docIdError,hint:"Enter the 8-digit Document ID number, also referred to as the barcode number","persistent-hint":!0},scopedSlots:e._u([{key:"append",fn:function(){return[e.isVerifyingDocId?t("v-progress-circular",{staticClass:"my-0",attrs:{indeterminate:"",color:"primary",size:25,width:3}}):e._e(),!e.isVerifyingDocId&&e.isVerifiedDocId&&!e.generateDocumentId?t("v-icon",{staticClass:"success-icon"},[e._v(" mdi-check ")]):e._e()]},proxy:!0}]),model:{value:e.documentId,callback:function(o){e.documentId=o},expression:"documentId"}}),t("v-checkbox",{attrs:{color:"primary"},scopedSlots:e._u([{key:"label",fn:function(){return[t("span",{staticClass:"copy-label"},[e._v(" Generate a Document ID Number upon filing. ")]),t("v-tooltip",{attrs:{top:"",transition:"fade-transition","content-class":"top-tooltip"},scopedSlots:e._u([{key:"activator",fn:function({on:o,attrs:r}){return[t("v-icon",e._g(e._b({staticClass:"ml-1",attrs:{color:"primary",size:"20"}},"v-icon",r,!1),o),[e._v(" mdi-information-outline ")])]}}])},[t("div",[e._v(" Upon registration, a Document ID will be generated, and a corresponding document record will be created ")])])]},proxy:!0}]),model:{value:e.generateDocumentId,callback:function(o){e.generateDocumentId=o},expression:"generateDocumentId"}})],1)],1)],1)},$=[],b=C(s,O,$,!1,null,"ab480e5d",null,null);const N=b.exports;b.exports.__docgenInfo={exportName:"default",displayName:"DocumentId",description:"",tags:{},props:[{name:"docApiUrl",tags:{},description:"Document Services Api URL.",type:{name:"string"},defaultValue:{func:!1,value:"false"}},{name:"docApiKey",tags:{},description:"Document Services Api Key.",type:{name:"string"},defaultValue:{func:!1,value:"false"}},{name:"validate",tags:{},description:"Validation flag.",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"cardPadding",tags:{},description:"Card padding overrides",type:{name:"Array",elements:[{name:"string"}]},defaultValue:{func:!0,value:"() => ['pt-10 pl-4 pb-3 pr-4']"}}],events:[{name:"updateDocId",description:"Emits an event to update the Document ID.",properties:[{type:{names:["mixed"]},name:"docId",description:"The Document ID to emit."}],tags:[{title:"param",type:{name:"mixed"},name:"docId",description:"The Document ID to emit."}]},{name:"isValid",description:"Emits an event to update the validation state.",properties:[{type:{names:["mixed"]},name:"isValid",description:"The validation value to emit."}],tags:[{title:"param",type:{name:"mixed"},name:"isValid",description:"The validation value to emit."}]}],sourceFiles:["/home/severin/repos/bcrs-shared-components/src/components/document-id/DocumentId.vue"]};const M={title:"component/DocumentId"},V=(i,{argTypes:e})=>({vuetify:new k({iconfont:"mdi"}),props:Object.keys(e),components:{DocumentId:N},template:'<document-id v-bind="$props" />'}),u=V.bind({}),c=V.bind({});c.args={validate:!0};var I,D,g;u.parameters={...u.parameters,docs:{...(I=u.parameters)==null?void 0:I.docs,source:{originalSource:`(args, {
  argTypes
}) => ({
  vuetify: new Vuetify({
    iconfont: 'mdi'
  }),
  props: Object.keys(argTypes),
  components: {
    DocumentId
  },
  template: '<document-id v-bind="$props" />' // $props comes from args below
})`,...(g=(D=u.parameters)==null?void 0:D.docs)==null?void 0:g.source}}};var y,v,h;c.parameters={...c.parameters,docs:{...(y=c.parameters)==null?void 0:y.docs,source:{originalSource:`(args, {
  argTypes
}) => ({
  vuetify: new Vuetify({
    iconfont: 'mdi'
  }),
  props: Object.keys(argTypes),
  components: {
    DocumentId
  },
  template: '<document-id v-bind="$props" />' // $props comes from args below
})`,...(h=(v=c.parameters)==null?void 0:v.docs)==null?void 0:h.source}}};const W=["Default","error"];export{u as Default,W as __namedExportsOrder,M as default,c as error};
//# sourceMappingURL=DocumentId.stories-d3f92020.js.map
