var X=Object.defineProperty;var ee=(r,e,s)=>e in r?X(r,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[e]=s;var m=(r,e,s)=>(ee(r,typeof e!="symbol"?e+"":e,s),s);import{V as se}from"./vue.esm-b1e57a2f.js";import{p as re}from"./params-036f571e.js";import{c as te,m as ae,C as de,P as f,E as W,n as ne}from"./_plugin-vue2_normalizer-b11a0120.js";import{W as p}from"./Watch-62f8b699.js";import{l as ie}from"./lodash-f6b38868.js";import{V as K,C as Y}from"./validation-mixin-2ad1b825.js";var a={},A={},d={},L={};Object.defineProperty(L,"__esModule",{value:!0});var oe=re.withParams;L.default=oe;Object.defineProperty(d,"__esModule",{value:!0});d.regex=d.ref=d.len=d.req=d.withParams=void 0;var le=L,G=ue(le);function ue(r){return r&&r.__esModule?r:{default:r}}d.withParams=G.default;var ce=d.req=function(e){if(Array.isArray(e))return!!e.length;if(e==null||e===!1)return!1;if(e instanceof Date)return!isNaN(e.getTime());if(typeof e=="object"){for(var s in e)return!0;return!1}return!!String(e).length};d.len=function(e){return Array.isArray(e)?e.length:typeof e=="object"?Object.keys(e).length:String(e).length};d.ref=function(e,s,t){return typeof e=="function"?e.call(s,t):t[e]};d.regex=function(e,s){return(0,G.default)({type:e},function(t){return!ce(t)||s.test(t)})};Object.defineProperty(A,"__esModule",{value:!0});var me=d;A.default=(0,me.regex)("alpha",/^[a-zA-Z]*$/);var b={};Object.defineProperty(b,"__esModule",{value:!0});var fe=d;b.default=(0,fe.regex)("alphaNum",/^[a-zA-Z0-9]*$/);var x={};Object.defineProperty(x,"__esModule",{value:!0});var pe=d;x.default=(0,pe.regex)("numeric",/^[0-9]*$/);var P={};Object.defineProperty(P,"__esModule",{value:!0});var U=d;P.default=function(r,e){return(0,U.withParams)({type:"between",min:r,max:e},function(s){return!(0,U.req)(s)||(!/\s/.test(s)||s instanceof Date)&&+r<=+s&&+e>=+s})};var w={};Object.defineProperty(w,"__esModule",{value:!0});var he=d,ve=/(^$|^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$)/;w.default=(0,he.regex)("email",ve);var R={};Object.defineProperty(R,"__esModule",{value:!0});var k=d;R.default=(0,k.withParams)({type:"ipAddress"},function(r){if(!(0,k.req)(r))return!0;if(typeof r!="string")return!1;var e=r.split(".");return e.length===4&&e.every(_e)});var _e=function(e){if(e.length>3||e.length===0||e[0]==="0"&&e!=="0"||!e.match(/^\d+$/))return!1;var s=+e|0;return s>=0&&s<=255},q={};Object.defineProperty(q,"__esModule",{value:!0});var E=d;q.default=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:":";return(0,E.withParams)({type:"macAddress"},function(e){if(!(0,E.req)(e))return!0;if(typeof e!="string")return!1;var s=typeof r=="string"&&r!==""?e.split(r):e.length===12||e.length===16?e.match(/.{2}/g):null;return s!==null&&(s.length===6||s.length===8)&&s.every(ye)})};var ye=function(e){return e.toLowerCase().match(/^[0-9a-f]{2}$/)},$={};Object.defineProperty($,"__esModule",{value:!0});var _=d;$.default=function(r){return(0,_.withParams)({type:"maxLength",max:r},function(e){return!(0,_.req)(e)||(0,_.len)(e)<=r})};var O={};Object.defineProperty(O,"__esModule",{value:!0});var y=d;O.default=function(r){return(0,y.withParams)({type:"minLength",min:r},function(e){return!(0,y.req)(e)||(0,y.len)(e)>=r})};var I={};Object.defineProperty(I,"__esModule",{value:!0});var T=d;I.default=(0,T.withParams)({type:"required"},T.req);var V={};Object.defineProperty(V,"__esModule",{value:!0});var g=d;V.default=function(r){return(0,g.withParams)({type:"requiredIf",prop:r},function(e,s){return(0,g.ref)(r,this,s)?(0,g.req)(e):!0})};var M={};Object.defineProperty(M,"__esModule",{value:!0});var C=d;M.default=function(r){return(0,C.withParams)({type:"requiredUnless",prop:r},function(e,s){return(0,C.ref)(r,this,s)?!0:(0,C.req)(e)})};var j={};Object.defineProperty(j,"__esModule",{value:!0});var Z=d;j.default=function(r){return(0,Z.withParams)({type:"sameAs",eq:r},function(e,s){return e===(0,Z.ref)(r,this,s)})};var S={};Object.defineProperty(S,"__esModule",{value:!0});var ge=d,Ce=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i;S.default=(0,ge.regex)("url",Ce);var N={};Object.defineProperty(N,"__esModule",{value:!0});var Ae=d;N.default=function(){for(var r=arguments.length,e=Array(r),s=0;s<r;s++)e[s]=arguments[s];return(0,Ae.withParams)({type:"or"},function(){for(var t=this,o=arguments.length,c=Array(o),i=0;i<o;i++)c[i]=arguments[i];return e.length>0&&e.reduce(function(h,v){return h||v.apply(t,c)},!1)})};var B={};Object.defineProperty(B,"__esModule",{value:!0});var Le=d;B.default=function(){for(var r=arguments.length,e=Array(r),s=0;s<r;s++)e[s]=arguments[s];return(0,Le.withParams)({type:"and"},function(){for(var t=this,o=arguments.length,c=Array(o),i=0;i<o;i++)c[i]=arguments[i];return e.length>0&&e.reduce(function(h,v){return h&&v.apply(t,c)},!0)})};var z={};Object.defineProperty(z,"__esModule",{value:!0});var F=d;z.default=function(r){return(0,F.withParams)({type:"minValue",min:r},function(e){return!(0,F.req)(e)||(!/\s/.test(e)||e instanceof Date)&&+e>=+r})};var D={};Object.defineProperty(D,"__esModule",{value:!0});var H=d;D.default=function(r){return(0,H.withParams)({type:"maxValue",max:r},function(e){return!(0,H.req)(e)||(!/\s/.test(e)||e instanceof Date)&&+e<=+r})};Object.defineProperty(a,"__esModule",{value:!0});a.maxValue=a.minValue=a.and=a.or=a.url=a.sameAs=a.requiredUnless=a.requiredIf=J=a.required=a.minLength=ds=a.maxLength=a.macAddress=a.ipAddress=a.email=a.between=a.numeric=a.alphaNum=a.alpha=void 0;var be=A,xe=n(be),Pe=b,we=n(Pe),Re=x,qe=n(Re),$e=P,Oe=n($e),Ie=w,Ve=n(Ie),Me=R,je=n(Me),Se=q,Ne=n(Se),Be=$,ze=n(Be),De=O,Ue=n(De),ke=I,Ee=n(ke),Te=V,Ze=n(Te),Fe=M,He=n(Fe),We=j,Ke=n(We),Ye=S,Ge=n(Ye),Je=N,Qe=n(Je),Xe=B,es=n(Xe),ss=z,rs=n(ss),ts=D,as=n(ts);function n(r){return r&&r.__esModule?r:{default:r}}a.alpha=xe.default;a.alphaNum=we.default;a.numeric=qe.default;a.between=Oe.default;a.email=Ve.default;a.ipAddress=je.default;a.macAddress=Ne.default;var ds=a.maxLength=ze.default;a.minLength=Ue.default;var J=a.required=Ee.default;a.requiredIf=Ze.default;a.requiredUnless=He.default;a.sameAs=Ke.default;a.url=Ge.default;a.or=Qe.default;a.and=es.default;a.minValue=rs.default;a.maxValue=as.default;const ns=function(){const r=this.$vnode.componentOptions.Ctor.options.__validations||{},e={};for(const s in r){if(!r.hasOwnProperty(s))continue;let t=r[s];s==="__validations__"&&(t=this[t]),typeof t=="function"&&(t=t.call(this)),s==="__validations__"?Object.assign(e,t):e[s]=t}return e};function is(){return te((r,e)=>{r.__validations||(r.__validations={}),r.__validations.__validations__=e,r.validations=ns})}var os=Object.defineProperty,ls=Object.getOwnPropertyDescriptor,u=(r,e,s,t)=>{for(var o=t>1?void 0:t?ls(e,s):e,c=r.length-1,i;c>=0;c--)(i=r[c])&&(o=(t?i(e,s,o):i(o))||o);return t&&o&&os(e,s,o),o};let l=class extends ae(K,Y){constructor(){super(...arguments);m(this,"address");m(this,"editing");m(this,"schema");m(this,"noPoBox");m(this,"addressLocal",{});m(this,"schemaLocal",{});m(this,"uniqueId",ie.uniqueId());m(this,"spaceRules",[s=>!/^\s/g.test(s)||"Invalid spaces",s=>!/\s$/g.test(s)||"Invalid spaces",s=>!/\s\s/g.test(s)||"Invalid word spacing"])}validations(){return{addressLocal:{...this.schemaLocal}}}resetRegion(){this.addressLocal.addressRegion=""}get streetAddressId(){return`street-address-${this.uniqueId}`}addressCountryId(){return`address-country-${this.uniqueId}`}get addressCountry(){return this.addressLocal.addressCountry}get streetAddressAdditionalLabel(){return"Additional Street Address"+(this.isSchemaRequired("streetAddressAdditional")?"":" (Optional)")}get streetAddressLabel(){return"Street Address"+(this.isSchemaRequired("streetAddress")?"":" (Optional)")}get addressCityLabel(){return"City"+(this.isSchemaRequired("addressCity")?"":" (Optional)")}get addressRegionLabel(){let s,t=this.isSchemaRequired("addressRegion");return this.addressLocal.addressCountry==="CA"?(s="Province",t=!0):this.addressLocal.addressCountry==="US"?(s="State",t=!0):s="Province/State",s+(t?"":" (Optional)")}get postalCodeLabel(){let s;return this.addressLocal.addressCountry==="US"?s="Zip Code":s="Postal Code",s+(this.isSchemaRequired("postalCode")?"":" (Optional)")}get addressCountryLabel(){return"Country"+(this.isSchemaRequired("addressCountry")?"":" (Optional)")}get deliveryInstructionsLabel(){return"Delivery Instructions"+(this.isSchemaRequired("deliveryInstructions")?"":" (Optional)")}get streetAddressHint(){return this.noPoBox?"Address cannot be a PO Box":""}isSchemaRequired(s){return!!(this.schemaLocal&&this.schemaLocal[s]&&this.schemaLocal[s].required)}get rules(){return this.createVuetifyRulesObject("addressLocal")}emitAddress(s){}emitValid(s){}onSchemaChanged(){this.schemaLocal={...this.schema}}onAddressChanged(){this.addressLocal={...this.address}}onAddressCountryChanged(){if(this.schema)if(this.useCountryRegions(this.addressLocal.addressCountry)){const s={...this.schema.addressRegion,required:J};this.schemaLocal={...this.schema,addressRegion:s}}else{const{required:s,...t}=this.schema.addressRegion;this.schemaLocal={...this.schema,addressRegion:t}}}onAddressLocalChanged(){this.emitAddress(this.addressLocal),this.emitValid(!this.$v.$invalid)}useCountryRegions(s){return s==="CA"||s==="US"}enableAddressComplete(){const s=window.pca,t=window.addressCompleteKey;if(!s||!t){console.log("AddressComplete not initialized due to missing script and/or key");return}window.currentAddressComplete&&window.currentAddressComplete.destroy(),window.currentAddressComplete=this.createAddressComplete(s,t)}createAddressComplete(s,t){const o=[{element:this.streetAddressId,field:"Line1",mode:s.fieldMode.SEARCH},{element:this.addressCountryId,field:"CountryName",mode:s.fieldMode.COUNTRY}],c={key:t},i=new s.Address(o,c);return i.listen("populate",this.addressCompletePopulate),i}addressCompletePopulate(s){const t={};t.streetAddress=s.Line1||"N/A",t.streetAddressAdditional=this.combineLines(this.combineLines(s.Line2,s.Line3),this.combineLines(s.Line4,s.Line5)),t.addressCity=s.City,this.useCountryRegions(s.CountryIso2)?t.addressRegion=s.ProvinceCode:(t.addressRegion=null,t.streetAddressAdditional=this.combineLines(t.streetAddressAdditional,s.ProvinceName)),t.postalCode=s.PostalCode,t.addressCountry=s.CountryIso2,this.addressLocal=t,se.nextTick(()=>{this.$refs.addressForm.validate()})}combineLines(s,t){return s?t?s+`
`+t:s:t}};u([is()],l.prototype,"validations",1);u([f({default:()=>({streetAddress:"",streetAddressAdditional:"",addressCity:"",addressRegion:"",postalCode:"",addressCountry:"",deliveryInstructions:""})})],l.prototype,"address",2);u([f({default:!1})],l.prototype,"editing",2);u([f({default:null})],l.prototype,"schema",2);u([f({default:!1})],l.prototype,"noPoBox",2);u([W("update:address")],l.prototype,"emitAddress",1);u([W("valid")],l.prototype,"emitValid",1);u([p("schema",{deep:!0,immediate:!0})],l.prototype,"onSchemaChanged",1);u([p("address",{deep:!0,immediate:!0})],l.prototype,"onAddressChanged",1);u([p("addressCountry")],l.prototype,"onAddressCountryChanged",1);u([p("addressLocal",{deep:!0,immediate:!0})],l.prototype,"onAddressLocalChanged",1);l=u([de({mixins:[K,Y]})],l);var us=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("div",{staticClass:"base-address"},[s("v-expand-transition",[e.editing?e._e():s("div",{staticClass:"address-block"},[s("div",{staticClass:"address-block__info pre-line"},[s("div",{staticClass:"address-block__info-row street-address"},[e._v(" "+e._s(e.addressLocal.streetAddress)+" ")]),s("div",{staticClass:"address-block__info-row street-address-additional"},[e._v(" "+e._s(e.addressLocal.streetAddressAdditional)+" ")]),s("div",{staticClass:"address-block__info-row"},[s("span",{staticClass:"address-city"},[e._v(e._s(e.addressLocal.addressCity))]),e.addressLocal.addressRegion?[s("span",{staticClass:"address-region"},[e._v(" "+e._s(e.addressLocal.addressRegion))])]:e._e(),e.addressLocal.postalCode?[s("span",{staticClass:"postal-code"},[e._v(" "+e._s(e.addressLocal.postalCode))])]:e._e()],2),s("div",{staticClass:"address-block__info-row address-country"},[e._v(" "+e._s(e.getCountryName(e.addressCountry))+" ")]),e.addressLocal.deliveryInstructions?[s("div",{staticClass:"address-block__info-row delivery-instructions mt-5 font-italic"},[e._v(" "+e._s(e.addressLocal.deliveryInstructions)+" ")])]:e._e()],2)])]),s("v-expand-transition",[e.editing?s("v-form",{ref:"addressForm",attrs:{name:"address-form","lazy-validation":""}},[s("div",{staticClass:"form__row"},[s("v-text-field",{staticClass:"street-address",attrs:{id:e.streetAddressId,autocomplete:"chrome-off",name:Math.random(),filled:"",hint:e.streetAddressHint,"persistent-hint":"",label:e.streetAddressLabel,rules:[...e.rules.streetAddress,...e.spaceRules]},on:{"~keypress":function(t){return e.enableAddressComplete()},click:function(t){return e.enableAddressComplete()}},model:{value:e.addressLocal.streetAddress,callback:function(t){e.$set(e.addressLocal,"streetAddress",t)},expression:"addressLocal.streetAddress"}})],1),s("div",{staticClass:"form__row"},[s("v-textarea",{staticClass:"street-address-additional",attrs:{"auto-grow":"",filled:"",label:e.streetAddressAdditionalLabel,rows:"1",rules:[...e.rules.streetAddressAdditional,...e.spaceRules]},model:{value:e.addressLocal.streetAddressAdditional,callback:function(t){e.$set(e.addressLocal,"streetAddressAdditional",t)},expression:"addressLocal.streetAddressAdditional"}})],1),s("div",{staticClass:"form__row three-column"},[s("v-text-field",{staticClass:"item address-city",attrs:{filled:"",label:e.addressCityLabel,rules:[...e.rules.addressCity,...e.spaceRules]},model:{value:e.addressLocal.addressCity,callback:function(t){e.$set(e.addressLocal,"addressCity",t)},expression:"addressLocal.addressCity"}}),e.useCountryRegions(e.addressCountry)?s("v-select",{staticClass:"item address-region",attrs:{filled:"","menu-props":{maxHeight:"40rem"},label:e.addressRegionLabel,"item-text":"name","item-value":"short",items:e.getCountryRegions(e.addressCountry),rules:[...e.rules.addressRegion,...e.spaceRules]},model:{value:e.addressLocal.addressRegion,callback:function(t){e.$set(e.addressLocal,"addressRegion",t)},expression:"addressLocal.addressRegion"}}):s("v-text-field",{staticClass:"item address-region",attrs:{filled:"",label:e.addressRegionLabel,rules:[...e.rules.addressRegion,...e.spaceRules]},model:{value:e.addressLocal.addressRegion,callback:function(t){e.$set(e.addressLocal,"addressRegion",t)},expression:"addressLocal.addressRegion"}}),s("v-text-field",{staticClass:"item postal-code",attrs:{filled:"",label:e.postalCodeLabel,rules:[...e.rules.postalCode,...e.spaceRules]},model:{value:e.addressLocal.postalCode,callback:function(t){e.$set(e.addressLocal,"postalCode",t)},expression:"addressLocal.postalCode"}})],1),s("div",{staticClass:"form__row"},[s("v-select",{staticClass:"address-country",attrs:{filled:"",label:e.addressCountryLabel,"menu-props":"auto","item-text":"name","item-value":"code",items:e.getCountries(),rules:[...e.rules.addressCountry,...e.spaceRules]},on:{change:function(t){return e.resetRegion()}},model:{value:e.addressLocal.addressCountry,callback:function(t){e.$set(e.addressLocal,"addressCountry",t)},expression:"addressLocal.addressCountry"}}),s("input",{attrs:{id:e.addressCountryId,type:"hidden"},domProps:{value:e.addressCountry}})],1),s("div",{staticClass:"form__row"},[s("v-textarea",{staticClass:"delivery-instructions",attrs:{"auto-grow":"",filled:"",label:e.deliveryInstructionsLabel,rows:"2",rules:[...e.rules.deliveryInstructions,...e.spaceRules]},model:{value:e.addressLocal.deliveryInstructions,callback:function(t){e.$set(e.addressLocal,"deliveryInstructions",t)},expression:"addressLocal.deliveryInstructions"}})],1)]):e._e()],1)],1)},cs=[],Q=ne(l,us,cs,!1,null,"ff66b22e",null,null);const Cs=Q.exports;Q.exports.__docgenInfo={description:`The component for displaying and editing an address.
Vuelidate is used to implement the validation rules (eg, what 'required' means and whether it's satisfied).
Vuetify is used to display any validation errors/styling.
Optionally uses Canada Post AddressComplete (aka Postal Code Anywhere - PCA) for address lookup.`,tags:{},exportName:"default",displayName:"BaseAddress",props:[{name:"address",tags:{},description:`The address to be displayed/edited.
Default is "empty address" in case parent doesn't provide it (eg, for new address).`,type:{name:"object"},defaultValue:{func:!0,value:`() => ({
  streetAddress: '',
  streetAddressAdditional: '',
  addressCity: '',
  addressRegion: '',
  postalCode: '',
  addressCountry: '',
  deliveryInstructions: ''
})`}},{name:"editing",tags:{},description:"Whether the address should be shown in editing mode (true) or display mode (false).",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"schema",tags:{},description:"The address schema containing Vuelidate rules.",type:{name:"any"},defaultValue:{func:!1,value:"null"}},{name:"noPoBox",tags:{},type:{name:"boolean"},defaultValue:{func:!1,value:"false"}}],events:[{name:"update:address",description:'Emits an update message for the address prop, so that the caller can ".sync" with it.'},{name:"valid",description:"Emits the validity of the address entered by the user."}],sourceFiles:["/home/severin/repos/bcrs-shared-components/src/components/base-address/BaseAddress.vue","/home/severin/repos/bcrs-shared-components/src/mixins/countries-provinces-mixin.ts","/home/severin/repos/bcrs-shared-components/src/mixins/validation-mixin.ts"]};export{Cs as B,ds as m,J as r};
//# sourceMappingURL=BaseAddress-416de270.js.map
